(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t,a){e.exports=a(147)},147:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(43),i=a.n(s),c=a(2),o=a(3),l=a(6),u=a(4),p=a(5),m=a(8),d=(a(15),Object.freeze({ASYNC_SUCCESS:"ASYNC_SUCCESS",ASYNC_ERROR:"ASYNC_ERROR",ASYNC_LOADING:"ASYNC_LOADING",NORMAL_ACTION:"NORMAL_ACTION",DB_MESSAGE_STATUS:"DB_MESSAGE_STATUS",DB_MESSAGE_CREATION_LOADING:"DB_MESSAGE_CREATION_LOADING",DB_MESSAGE_GET_LOADING:"DB_MESSAGE_GET_LOADING",DB_SAVE_MESSAGES:"DB_SAVE_MESSAGES",DB_MESSAGE_TYPES_GET:"DB_MESSAGE_TYPES_GET",DB_MESSAGE_TYPES_SAVED:"DB_MESSAGE_TYPES_SAVED",SET_CURRENT_VIEW_FROM_URI:"SET_CURRENT_VIEW_FROM_URI",DB_MESSAGE_SAVED:"DB_MESSAGE_SAVED",DB_MESSAGES_GET:"DB_MESSAGES_GET",DB_RETURNED_MESSAGE:"DB_RETURNED_MESSAGE",RESET_MESSAGE_PREVIEW:"RESET_MESSAGE_PREVIEW",SET_SELECTED_SCHEMA:"SET_SELECTED_SCHEMA",SET_PREVIEW_SCHEMA:"SET_PREVIEW_SCHEMA",OPEN_MODAL:"OPEN_MODAL",CLOSE_MODAL:"CLOSE_MODAL",SET_CURRENT_GAME_SETUP_TAB:"SET_CURRENT_GAME_SETUP_TAB",SET_GAME_SETUP_DATA:"SET_GAME_SETUP_DATA",ALL_WARGAME_NAMES_SAVED:"ALL_WARGAME_NAMES_SAVED",SET_CURRENT_WARGAME:"SET_CURRENT_WARGAME",ADD_NEW_FORCE:"ADD_NEW_FORCE",SET_SELECTED_FORCE:"SET_SELECTED_FORCE",ADD_NEW_CHANNEL:"ADD_NEW_CHANNEL",SET_SELECTED_CHANNEL:"SET_SELECTED_CHANNEL",DELETE_SELECTED_CHANNEL:"DELETE_SELECTED_CHANNEL",SET_WARGAME_NAME:"SET_WARGAME_NAME",SET_FORCE_OVERVIEW:"SET_FORCE_OVERVIEW",GAME_TITLE_INVALID:"GAME_TITLE_INVALID",ADD_NEW_RECIPIENT:"ADD_NEW_RECIPIENT",ADD_NOTIFICATION:"ADD_NOTIFICATION",HIDE_NOTIFICATION:"HIDE_NOTIFICATION",UPDATE_RECIPIENT:"UPDATE_RECIPIENT",REMOVE_RECIPIENT:"REMOVE_RECIPIENT",SET_CURRENT_WARGAME_PLAYER:"SET_CURRENT_WARGAME_PLAYER",SET_FORCE:"SET_FORCE",SET_ROLE:"SET_ROLE",SET_FILTERED_CHANNELS:"SET_FILTERED_CHANNELS",SET_CHANNEL:"SET_CHANNEL",SET_MESSAGE_SCHEMA:"SET_MESSAGE_SCHEMA",SET_LATEST_MESSAGES:"SET_LATEST_MESSAGES",POPULATE_MESSAGE_TYPES_DB:"POPULATE_MESSAGE_TYPES_DB",POPULATE_WARGAMES_DB:"POPULATE_WARGAMES_DB",SET_UNSAVED_STATE:"SET_UNSAVED_STATE",UPDATE_CHANNEL_NAME:"UPDATE_CHANNEL_NAME"})),h={open:function(e,t){return{type:d.OPEN_MODAL,payload:{open:!0,modal:e,data:t||null}}},close:function(){return{type:d.CLOSE_MODAL,payload:{open:!1,modal:""}}}},f=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleBackgroundClick=function(e){e.target===e.currentTarget&&a.props.dispatch(h.close())},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.editable?"modal setsize":"modal";return r.a.createElement("div",{className:"modal-bg",onClick:this.handleBackgroundClick},r.a.createElement("div",{className:e},this.props.children))}}]),t}(n.Component),g=Object(m.b)()(f),E=a(7),v=a.n(E),y=a(14),b=a(50),w=a(20),S=a.n(w),O=a(27),_=a(25),T=a.n(_);function j(e){if(null===e||"object"!==typeof e)return e;var t=e.constructor();for(var a in e)t[a]=j(e[a]);return t}function N(e){var t=S.a.omit(e,["complete","selectedForce","selectedChannel"]);return S.a.flatMapDeep(t,function e(t){return S.a.isEmpty(t)?null:S.a.isArray(t)||S.a.isObject(t)?S.a.flatMapDeep(t,e):t}).every(function(e){return null!==e&&e.length>0})}var k=a(45),C="https://serge-dev.herokuapp.com/",M="https://serge-dev.herokuapp.com/db/",A={forceName:"",overview:"An overview written here..",roles:["General"]},I={channelName:"",participants:[]},x={_id:"_local/settings",wargameTitle:"",data:{overview:{name:"Overview - settings",gameDescription:"",spatialRepresentation:"",planningInterval:null,replayInterval:null,turnStrategy:"",complete:!1},forces:{name:"Forces",forces:[],roles:["General"],selectedForce:"",complete:!1},channels:{name:"Channels",channels:[],selectedChannel:"",complete:!1}}},R=a(85),D=a(86),L=new k.a(M+"message_types"),P=function(e){return new Promise(function(t,a){Object(y.a)(v.a.mark(function n(){var r,s,i;return v.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,G();case 2:if(r=n.sent,!r.find(function(t){return t.title.toLowerCase()===e.title.toLowerCase()})){n.next=7;break}return a("Message title already used"),n.abrupt("return");case 7:return s=(new Date).toISOString(),i={_id:s,lastUpdated:s,title:e.title,details:e,completed:!1},n.abrupt("return",L.put(i).then(function(e){t(e)}).catch(function(e){console.log(e),a(!1)}));case 10:case"end":return n.stop()}},n)}))()})},W=function(e){var t=(new Date).toISOString();return new Promise(function(a,n){L.get(e).then(function(e){return e.details.title="".concat(e.details.title," Copy-").concat(T.a.time()),L.put({_id:t,lastUpdated:t,title:e.details.title,details:e.details})}).then(function(){a(!0)}).catch(function(e){console.log(e),n(!1)})})},F=function(e,t){return new Promise(function(a,n){Object(y.a)(v.a.mark(function r(){var s;return v.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,G();case 2:if(s=r.sent,!s.find(function(t){return t.title.toLowerCase()===e.title.toLowerCase()})){r.next=7;break}return n("Message title already used"),r.abrupt("return");case 7:L.get(t).then(function(t){return L.put({_id:t._id,lastUpdated:(new Date).toISOString(),_rev:t._rev,title:e.title,details:e})}).then(function(e){a(e)}).catch(function(e){console.log(e),n(!1)});case 8:case"end":return r.stop()}},r)}))()})},U=function(e){return new Promise(function(t,a){L.get(e).then(function(e){return L.remove(e)}).then(function(e){t(e)}).catch(function(e){console.log(e),a(!1)})})},G=function(){return new Promise(function(e,t){return L.changes({since:1,include_docs:!0,descending:!0}).then(function(t){var a=t.results.map(function(e){return e.doc});a=a.filter(function(e){return!e.hasOwnProperty("_deleted")&&e.hasOwnProperty("details")}),e(a)}).catch(function(e){t(e),console.log(e)})})},V=function(e){return{type:d.SET_FORCE,payload:e}},B=function(e){return{type:d.SET_ROLE,payload:e}},H=function(){return{type:d.SET_FILTERED_CHANNELS}},q=function(e){return{type:d.SET_CHANNEL,payload:e}},$=function(e){return{type:d.SET_MESSAGE_SCHEMA,payload:e}},Y=function(e){return{type:d.SET_LATEST_MESSAGES,payload:e}},Q=function(e){return function(){var t=Object(y.a)(v.a.mark(function t(a){var n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,pe(e);case 2:n=t.sent,console.log(n),a((r=n,{type:d.SET_CURRENT_WARGAME_PLAYER,payload:r}));case 5:case"end":return t.stop()}var r},t)}));return function(e){return t.apply(this,arguments)}}()},z=function(e,t,a){return function(){var n=Object(y.a)(v.a.mark(function n(r){var s;return v.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,me(e,t,a);case 2:return n.next=4,de(e);case 4:s=n.sent,r(Y(s));case 6:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()},J=function(e){return function(){var t=Object(y.a)(v.a.mark(function t(a){var n,r;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G();case 2:n=t.sent,r=n.find(function(t){return t._id===e}),a($(r.details));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},Z=function(e){return function(){var t=Object(y.a)(v.a.mark(function t(a){var n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,de(e);case 2:n=t.sent,a(Y(n));case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},K=[],X=function(e){return Object(b.a)(C+"allDbs").then(function(e){return e.json()}).then(function(t){var a=K.map(function(e){return e.name}),n=S.a.difference(t,a);(n=S.a.pull(n,"messages","message_types","_replicator","_users")).forEach(function(t){var a=new k.a(M+t);a.setMaxListeners(15),function e(t,a,n){t.changes({since:"now",live:!0,timeout:!1,heartbeat:!1}).on("change",function(){Object(y.a)(v.a.mark(function e(){var t;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de(a);case 2:t=e.sent,n(Y(t));case 4:case"end":return e.stop()}},e)}))()}).on("error",function(r){console.log(r),e(t,a,n)})}(a,t,e),K.unshift({name:t,db:a})});var r=K.map(function(e){return e.db.get(x._id).then(function(t){return{name:e.db.name,title:t.wargameTitle}}).catch(function(e){console.log(e)})});return Promise.all(r)}).catch(function(e){console.log(e)})},ee=function(e){var t=fe(e);K.find(function(e){return e.name===t}).db.destroy();var a=K.findIndex(function(e){return e.name===t});K.splice(a,1)},te=function(){var e=T.a.time(),t="wargame-".concat(e);return new Promise(function(e,a){var n=new k.a(M+t);K.unshift({name:t,db:n});var r=Object(O.a)({},x,{name:t});r.wargameTitle=t,n.put(r).then(function(){return n.get(r._id)}).then(function(t){e(t)}).catch(function(e){a(e),console.log(e)})})},ae=function(e){var t=fe(e);return new Promise(function(e,a){try{K.find(function(e){return e.name===t}).db.get(x._id).then(function(t){e(t)})}catch(n){a(n)}})},ne=function(e,t){return he().then(function(a){if(a.some(function(a){return a.title===t&&fe(a.name)!==e}))return"Name already in use.";var n=K.find(function(t){return t.name===e}).db;return new Promise(function(a,r){n.get(x._id).then(function(s){n.put({_id:x._id,_rev:s._rev,name:e,wargameTitle:t,data:s.data}).then(function(){a(n.get(x._id))}).catch(function(e){r(e)})})})}).catch(function(e){return e})},re=function(e,t){var a=K.find(function(t){return e===t.name}).db;return new Promise(function(n,r){ue(e).then(function(e){var a=j(e);return a.data.overview=t,a.data.overview.complete=N(t),a}).then(function(e){return a.put({_id:e._id,_rev:e._rev,name:e.name,wargameTitle:e.wargameTitle,data:e.data})}).then(function(){n(a.get(x._id))}).catch(function(e){r(e)})})},se=function(e,t,a,n){var r=K.find(function(t){return e===t.name}).db;return ue(e).then(function(e){var s=j(e).data,i=s.forces.forces;if(i.every(function(e){return e.forceName!==n}))i.push(Object(O.a)({},a,{forceName:t}));else{var c=i.findIndex(function(e){return e.forceName===n});i.splice(c,1,Object(O.a)({},a,{forceName:t}))}return s.forces.forces=i,s.forces.complete=N(i),new Promise(function(e,t){r.get(x._id).then(function(a){r.put({_id:x._id,_rev:a._rev,name:a.name,wargameTitle:a.wargameTitle,data:s}).then(function(){e(r.get(x._id))}).catch(function(e){t(e)})})})})},ie=function(e,t,a,n){var r=K.find(function(t){return e===t.name}).db;return ue(e).then(function(e){var s=j(e).data,i=s.channels.channels;if(i.every(function(e){return e.channelName!==n}))i.push(Object(O.a)({},a,{channelName:t}));else{var c=i.findIndex(function(e){return e.channelName===n});i.splice(c,1,Object(O.a)({},a,{channelName:t}))}return s.channels.channels=i,s.channels.complete=N(i),new Promise(function(e,t){r.get(x._id).then(function(a){r.put({_id:x._id,_rev:a._rev,name:a.name,wargameTitle:a.wargameTitle,data:s}).then(function(){e(r.get(x._id))}).catch(function(e){t(e)})})})})},ce=function(e,t){var a=K.find(function(t){return e===t.name}).db;return ue(e).then(function(e){var n=j(e).data,r=n.channels.channels,s=r.findIndex(function(e){return e.channelName===t});return r.splice(s,1),n.channels.channels=r,n.channels.complete=N(r),new Promise(function(e,t){a.get(x._id).then(function(r){a.put({_id:x._id,_rev:r._rev,name:r.name,wargameTitle:r.wargameTitle,data:n}).then(function(){e(a.get(x._id))}).catch(function(e){t(e)})})})})},oe=function(e,t){var a=K.find(function(t){return e===t.name}).db;return ue(e).then(function(e){var n=j(e).data,r=n.forces.forces,s=r.findIndex(function(e){return e.forceName===t});return r.splice(s,1),n.forces.forces=r,n.channels.complete=N(r),new Promise(function(e,t){a.get(x._id).then(function(r){a.put({_id:x._id,_rev:r._rev,name:r.name,wargameTitle:r.wargameTitle,data:n}).then(function(){e(a.get(x._id))}).catch(function(e){t(e)})})})})},le=function(e){var t=fe(e),a=K.find(function(e){return e.name===t}).db,n=T.a.time();return new Promise(function(e,t){var r,s="wargame-".concat(n);a.get(x._id).then(function(e){return r=new k.a(M+s),e}).then(function(e){return r.put({_id:x._id,name:s,wargameTitle:"".concat(e.wargameTitle,"-").concat(n),data:e.data}).then(function(){return e})}).then(function(){return K.unshift({name:s,db:r}),he()}).then(function(t){e(t)}).catch(function(e){t(e),console.log(e)})})},ue=function(e){var t=K.find(function(t){return e===t.name});return new Promise(function(e,a){t.db.get(x._id).then(function(t){e(t)}).catch(function(e){a(e)})})},pe=function(e){var t=fe(e),a=K.find(function(e){return t===e.name});return new Promise(function(e,t){a.db.get(x._id).then(function(t){e(t)}).catch(function(e){t(e)})})},me=function(e,t,a){var n=K.find(function(t){return t.name===e}).db;return new Promise(function(e,r){n.put({_id:(new Date).toISOString(),details:t,message:a}).then(function(t){e(t)}).catch(function(e){console.log(e)})})},de=function(e){var t=K.find(function(t){return t.name===e}).db;return new Promise(function(e,a){t.allDocs({include_docs:!0,descending:!0}).then(function(t){e(t.rows.map(function(e){return e.doc}))}).catch(function(e){a(e)})})},he=function(){var e=K.map(function(e){return e.db.get(x._id).then(function(t){return{name:e.db.name,title:t.wargameTitle}}).catch(function(e){console.log(e)})});return Promise.all(e)},fe=function(e){var t=new URL(e).pathname,a=t.lastIndexOf("/");return t.substring(a+1)},ge=function(e,t){return{type:d.ADD_NOTIFICATION,payload:{message:e,type:t,id:T.a.time()}}},Ee=function(e){return function(t){t(function(e){return{type:d.HIDE_NOTIFICATION,id:e}}(e))}},ve=function(e){return{type:d.SET_CURRENT_GAME_SETUP_TAB,payload:e}},ye=function(e){return{type:d.SET_GAME_SETUP_DATA,payload:e}},be=function(e){return{type:d.SET_SELECTED_FORCE,payload:e}},we=function(e){return{type:d.ADD_NEW_CHANNEL,payload:e}},Se=function(e){return{type:d.ADD_NEW_FORCE,payload:e}},Oe=function(e){return{type:d.SET_SELECTED_CHANNEL,payload:e}},_e=function(e){return{type:d.SET_FORCE_OVERVIEW,payload:e}},Te=function(e){return{type:d.ALL_WARGAME_NAMES_SAVED,payload:e}},je=function(e){return{type:d.SET_CURRENT_WARGAME,payload:e}},Ne=function(e){return{type:d.ADD_NEW_RECIPIENT,payload:e}},ke=function(e,t){return{type:d.UPDATE_RECIPIENT,payload:{id:e,data:t}}},Ce=function(e){return{type:d.POPULATE_WARGAMES_DB,isLoading:e}},Me=function(){return function(){var e=Object(y.a)(v.a.mark(function e(t){var a,n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te();case 2:return a=e.sent,e.next=5,he();case 5:n=e.sent,t(Te(n)),t(je(S.a.omit(a,["_id","_rev"])));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Ae=function(){return function(){var e=Object(y.a)(v.a.mark(function e(t){var a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,void Object(b.a)(C+"clearAll").then(function(){window.location.reload(!0)});case 2:return e.next=4,he();case 4:a=e.sent,t(Te(a));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Ie=function(e){return function(){var t=Object(y.a)(v.a.mark(function t(a){var n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ee(e);case 2:return t.next=4,he();case 4:n=t.sent,a(Te(n));case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},xe=function(e,t){return function(){var a=Object(y.a)(v.a.mark(function a(n){var r,s;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ne(e,t);case 2:return r=a.sent,a.next=5,he();case 5:s=a.sent,console.log(s),n(Te(s)),n(je(r)),n(ge("Wargame name updated.","success"));case 10:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},Re=function(e,t){return function(){var a=Object(y.a)(v.a.mark(function a(n){var r;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,re(e,t);case 2:r=a.sent,n(je(r)),n(ge("Overview saved.","success"));case 5:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},De=function(e,t,a,n){return function(){var r=Object(y.a)(v.a.mark(function r(s){var i;return v.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,se(e,t,a,n);case 2:i=r.sent,console.log(i),s(je(i)),s(be(t)),s(ge("Force saved.","success"));case 7:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}()},Le=function(e,t,a,n){return function(){var r=Object(y.a)(v.a.mark(function r(s){var i;return v.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,ie(e,t,a,n);case 2:i=r.sent,s(je(i)),s(Oe(t)),s(ge("channel saved.","success"));case 6:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}()},Pe=function(e,t){return function(){var a=Object(y.a)(v.a.mark(function a(n){var r;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ce(e,t);case 2:r=a.sent,n(je(r)),n(ge("channel deleted.","success"));case 5:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},We=function(e,t){return function(){var a=Object(y.a)(v.a.mark(function a(n){var r;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,oe(e,t);case 2:r=a.sent,n(je(r)),n(ge("channel deleted.","success"));case 5:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},Fe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).hideModal=function(){a.setState({forceName:""}),a.props.dispatch(h.close())},a.setNewForceName=function(e){console.log(e.target.value),a.setState({forceName:e.target.value,sameName:a.props.wargame.data[a.props.wargame.currentTab].forces.some(function(t){return t===e.target.value})})},a.addForce=function(){a.props.dispatch(Se(a.state.forceName)),a.props.dispatch(be(a.state.forceName))},a.state={forceName:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){if(!this.props.currentModal.open)return!1;var e=this.state.forceName.length<1||this.state.sameName;return r.a.createElement(g,null,r.a.createElement("div",{className:"display-text-wrapper"},r.a.createElement("h3",null,"Create force"),!!this.state.sameName&&r.a.createElement("p",{className:"notification"},"Already exists"),r.a.createElement("input",{autoFocus:!0,className:"modal-input",type:"text",onChange:this.setNewForceName}),r.a.createElement("div",{className:"buttons"},r.a.createElement("button",{disabled:e,name:"add",className:"btn btn-action btn-action--primary",onClick:this.addForce},"Add"),r.a.createElement("button",{name:"cancel",className:"btn btn-action btn-action--secondary",onClick:this.hideModal},"Cancel"))))}}]),t}(n.Component),Ue=Object(m.b)(function(e){return{wargame:e.wargame,currentModal:e.currentModal}})(Fe),Ge=a(101),Ve=a(19),Be=a.n(Ve),He=new k.a(M+"messages"),qe=function(e,t){return new Promise(function(a,n){Object(y.a)(v.a.mark(function r(){var s,i,c;return v.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ye();case 2:if(s=r.sent,!s.find(function(t){return t.details.title===e.title&&t._id!==e.id})){r.next=7;break}return n("Message title already used"),r.abrupt("return");case 7:return i=(new Date).toISOString(),c={_id:i,lastUpdated:i,details:e,schema:t,completed:!1},r.abrupt("return",He.put(c).then(function(e){a(e)}).catch(function(e){console.log(e),n(!1)}));case 10:case"end":return r.stop()}},r)}))()})},$e=function(e){var t=(new Date).toISOString();return new Promise(function(a,n){He.get(e).then(function(e){var a=e.details;return a.title="".concat(a.title," Copy-").concat(T.a.time()),He.put({_id:t,lastUpdated:t,details:a,schema:e.schema})}).then(function(){a(!0)}).catch(function(e){console.log(e),n(!1)})})},Ye=function(){return new Promise(function(e,t){return He.changes({since:0,include_docs:!0,descending:!0}).then(function(t){var a=t.results.map(function(e){return e.doc});a=a.filter(function(e){return!e.hasOwnProperty("_deleted")&&e.hasOwnProperty("details")}),e(a)}).catch(function(e){t(e),console.log(e)})})},Qe=function(e,t){return new Promise(function(a,n){Object(y.a)(v.a.mark(function r(){var s;return v.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ye();case 2:if(s=r.sent,!s.find(function(a){return a.details.title===t.title&&a._id!==e})){r.next=7;break}return n("Message title already used"),r.abrupt("return");case 7:He.get(e).then(function(a){return He.put({_id:e,lastUpdated:(new Date).toISOString(),_rev:a._rev,details:t,schema:a.schema})}).then(function(e){a(e)}).catch(function(e){console.log(e),n(!1)});case 8:case"end":return r.stop()}},r)}))()})},ze=function(e){return new Promise(function(t,a){He.get(e,{include_docs:!0},function(e,n){e&&a("something went wrong"),t(n)})})},Je=function(e){return new Promise(function(t,a){He.get(e).then(function(e){return He.remove(e)}).then(function(e){t(e)}).catch(function(e){console.log(e),a(!1)})})},Ze=function(e){return{type:d.SET_CURRENT_VIEW_FROM_URI,payload:e}},Ke=function(e){return{type:d.DB_MESSAGE_STATUS,payload:e}},Xe=function(e){return{type:d.DB_MESSAGE_SAVED,payload:e}},et=function(e){return{type:d.DB_RETURNED_MESSAGE,payload:e}},tt=function(e){return{type:d.DB_MESSAGE_CREATION_LOADING,isLoading:e}},at=function(e){return{type:d.DB_MESSAGES_GET,isLoading:e}},nt=function(){return{type:d.RESET_MESSAGE_PREVIEW}},rt=function(e,t){if(!Be.a.object(e))throw Error("createMessageType() requires object with message, from & to NOT. ".concat(e));return function(){var a=Object(y.a)(v.a.mark(function a(n){var r,s;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n(tt(!0)),a.prev=1,a.next=4,qe(e,t);case 4:if((r=a.sent).err&&n(ge(r.err)),!r.ok){a.next=14;break}return n(Ke(r)),a.next=10,Ye();case 10:s=a.sent,n(Xe(s)),n(tt(!1)),n(Ze("/client/umpireMenu/library"));case 14:a.next=20;break;case 16:a.prev=16,a.t0=a.catch(1),n(tt(!1)),alert(a.t0);case 20:case"end":return a.stop()}},a,null,[[1,16]])}));return function(e){return a.apply(this,arguments)}}()},st=function(e){if(!Be.a.string(e))throw Error("duplicateMessage() requires a string Not. ".concat(e));return function(){var t=Object(y.a)(v.a.mark(function t(a){var n,r;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(tt(!0)),t.next=3,$e(e);case 3:if(!(n=t.sent)){t.next=10;break}return a(Ke(n)),t.next=8,Ye();case 8:r=t.sent,a(Xe(r));case 10:a(tt(!1));case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},it=function(e,t){if(!Be.a.object(e))throw Error("updateMessage() requires object with message, from & to NOT. ".concat(e));return function(){var a=Object(y.a)(v.a.mark(function a(n){var r,s,i,c,o;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n(tt(!0)),a.prev=1,a.next=4,Qe(t,e);case 4:if((r=a.sent).err&&n(ge(r.err)),!r.ok){a.next=16;break}return n(Ke(r)),a.next=10,Promise.all([Ye(),ze(r.id)]);case 10:s=a.sent,i=Object(Ge.a)(s),c=i[0],o=i[1],n(et(o)),n(Xe(c)),n(tt(!1)),n(Ze("/client/umpireMenu/library"));case 16:a.next=22;break;case 18:a.prev=18,a.t0=a.catch(1),n(tt(!1)),alert(a.t0);case 22:case"end":return a.stop()}},a,null,[[1,18]])}));return function(e){return a.apply(this,arguments)}}()},ct=function(e){if(!Be.a.string(e))throw Error("duplicateMessage() requires a string Not. ".concat(e));return function(){var t=Object(y.a)(v.a.mark(function t(a){var n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(tt(!0)),t.next=3,Je(e);case 3:if(!t.sent){t.next=12;break}return t.next=7,Ye();case 7:n=t.sent,a(Xe(n)),a(nt()),t.next=12;break;case 12:a(tt(!1));case 13:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},ot=function(e){if(!Be.a.string(e))throw Error("duplicateMessage() requires a string id..");return function(){var t=Object(y.a)(v.a.mark(function t(a){var n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(at(!0)),t.next=3,ze(e);case 3:n=t.sent,a(et(n)),a(at(!1));case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},lt=function(e){return{type:d.DB_MESSAGE_STATUS,payload:e}},ut=function(e){return{type:d.DB_MESSAGE_TYPES_SAVED,payload:e}},pt=function(e){return{type:d.DB_MESSAGE_CREATION_LOADING,isLoading:e}},mt=function(e){return{type:d.DB_MESSAGE_TYPES_GET,isLoading:e}},dt=function(e){return{type:d.POPULATE_MESSAGE_TYPES_DB,isLoading:e}},ht=function(e){if(!Be.a.object(e))throw Error("createMessageType() requires schema object & NOT. ".concat(e));return function(){var t=Object(y.a)(v.a.mark(function t(a){var n,r;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(pt(!0)),t.prev=1,t.next=4,P(e);case 4:if((n=t.sent).err&&(a(ge(n.err)),a(pt(!1))),!n.ok){t.next=14;break}return a(lt(n)),t.next=10,G();case 10:r=t.sent,a(ut(r)),a(pt(!1)),a(Ze("/client/umpireMenu/templates"));case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(1),console.log(t.t0);case 19:case"end":return t.stop()}},t,null,[[1,16]])}));return function(e){return t.apply(this,arguments)}}()},ft=function(e){if(!Be.a.string(e))throw Error("duplicateTemplate() requires a string Not. ".concat(e));return function(){var t=Object(y.a)(v.a.mark(function t(a){var n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(pt(!0)),t.next=3,W(e);case 3:if(!t.sent){t.next=10;break}return a(lt(!0)),t.next=8,G();case 8:n=t.sent,a(ut(n));case 10:a(pt(!1));case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},gt=function(e,t){if(!Be.a.object(e))throw Error("updateMessageType() requires schema & not ".concat(e));return function(){var a=Object(y.a)(v.a.mark(function a(n){var r,s;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n(pt(!0)),a.prev=1,a.next=4,F(e,t);case 4:if((r=a.sent).err&&(n(ge(r.err)),n(pt(!1))),!r.ok){a.next=14;break}return n(lt(r.ok)),a.next=10,G();case 10:s=a.sent,n(ut(s)),n(pt(!1)),n(Ze("/client/umpireMenu/templates"));case 14:a.next=20;break;case 16:a.prev=16,a.t0=a.catch(1),n(pt(!1)),alert(a.t0);case 20:case"end":return a.stop()}},a,null,[[1,16]])}));return function(e){return a.apply(this,arguments)}}()},Et=function(e){if(!Be.a.string(e))throw Error("deleteMessage() requires a string of id not. ".concat(e));return function(){var t=Object(y.a)(v.a.mark(function t(a){var n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(pt(!0)),t.next=3,U(e);case 3:if(!t.sent){t.next=11;break}return t.next=7,G();case 7:n=t.sent,a(ut(n)),t.next=11;break;case 11:a(pt(!1));case 12:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},vt=function(){return function(){var e=Object(y.a)(v.a.mark(function e(t){var a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(mt(!0)),e.next=3,G();case 3:a=e.sent,t(ut(a)),t(mt(!1));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},yt=function(e){return{type:d.SET_SELECTED_SCHEMA,payload:e}},bt=function(e){return{type:d.SET_PREVIEW_SCHEMA,payload:e}},wt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).hideModal=function(){a.props.dispatch(h.close())},a.deleteMessage=function(){"/client/umpireMenu/templates"===a.props.currentViewURI?(a.props.dispatch(Et(a.props.umpireMenu.selectedSchemaID)),a.props.dispatch(bt("")),a.props.dispatch(yt(""))):a.props.dispatch(ct(a.props.messages.messagePreviewId))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return!!this.props.currentModal.open&&r.a.createElement(g,null,r.a.createElement("div",{className:"display-text-wrapper"},r.a.createElement("h3",null,"Delete"),r.a.createElement("p",null,"This will permanently remove the message.",r.a.createElement("br",null),"Are you sure?"),r.a.createElement("div",{className:"buttons"},r.a.createElement("button",{name:"delete",className:"btn btn-action btn-action--primary",onClick:this.deleteMessage},"Delete"),r.a.createElement("button",{name:"cancel",className:"btn btn-action btn-action--secondary",onClick:this.hideModal},"Cancel"))))}}]),t}(n.Component),St=Object(m.b)(function(e){return{currentModal:e.currentModal,messages:e.messages,umpireMenu:e.umpireMenu,currentViewURI:e.currentViewURI}})(wt),Ot=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).hideModal=function(){a.props.dispatch(h.close())},a.deleteWargame=function(){a.props.dispatch(Ie(a.props.currentModal.data))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return!!this.props.currentModal.open&&r.a.createElement(g,null,r.a.createElement("div",{className:"display-text-wrapper"},r.a.createElement("h3",null,"Delete"),r.a.createElement("p",null,"This will permanently delete the wargame.",r.a.createElement("br",null),"Are you sure?"),r.a.createElement("div",{className:"buttons"},r.a.createElement("button",{name:"delete",className:"btn btn-action btn-action--primary",onClick:this.deleteWargame},"Delete"),r.a.createElement("button",{name:"cancel",className:"btn btn-action btn-action--secondary",onClick:this.hideModal},"Cancel"))))}}]),t}(n.Component),_t=Object(m.b)(function(e){return{currentModal:e.currentModal,messages:e.messages,umpireMenu:e.umpireMenu,currentViewURI:e.currentViewURI}})(Ot),Tt=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e;switch(this.props.currentModal.modal){case"addForce":e=r.a.createElement(Ue,null);break;case"delete":e=r.a.createElement(St,null);break;case"deleteWargame":e=r.a.createElement(_t,null);break;default:e=!1}return r.a.createElement(r.a.Fragment,null,e)}}]),t}(n.Component),jt=Object(m.b)(function(e){return{currentModal:e.currentModal}})(Tt),Nt=a(10),kt=a(11),Ct=a(21),Mt=a.n(Ct),At=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onClickHandler=function(){a.props.onClickHandler(a.props.data.id)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.timer=setTimeout(function(){e.props.onClickHandler(e.props.data.id)},2e3)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"render",value:function(){var e="active "+(this.props.data.type?this.props.data.type:"");return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"notification",className:e,key:this.props.data.id},this.props.data.message,r.a.createElement(kt.a,{icon:Nt.f,onClick:this.onClickHandler})))}}]),t}(n.Component),It=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onClickHandler=function(e){a.props.dispatch(Ee(e))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return 0!==this.props.notifications.length&&r.a.createElement(r.a.Fragment,null,this.props.notifications.map(function(t){return r.a.createElement(At,{key:t.message,data:t,onClickHandler:e.onClickHandler})}))}}]),t}(n.Component),xt=Object(m.b)(function(e){return{notifications:e.notifications}})(It),Rt=a(87),Dt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onClickHandler=function(e){a.props.onClickHandler&&a.props.onClickHandler();var t=e.metaKey||e.ctrlKey,n=a.props.href.startsWith("http");t||n||(e.preventDefault(),a.props.dispatch(Ze(a.props.href)))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("span",{href:this.props.href,onClick:this.props.disabled?function(){return!1}:this.onClickHandler,id:this.props.id?this.props.id:null,className:this.props.class?this.props.class:null},this.props.children)}}]),t}(n.Component),Lt=Object(m.b)()(Dt),Pt=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(function(){var e=Object(y.a)(v.a.mark(function e(t){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(dt(!0)),e.next=3,new Promise(function(e,t){L.allDocs().then(function(t){if(0===t.rows.length){var a={_id:(new Date).toISOString(),lastUpdated:(new Date).toISOString(),title:"machinery failure",details:R,completed:!1};L.put(a),setTimeout(function(){var t={_id:(new Date).toISOString(),lastUpdated:(new Date).toISOString(),title:"weather forecast",details:D,completed:!1};L.put(t).then(function(){e(!0)})},2e3)}else e(!0)})});case 3:t(dt(!1));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),this.props.dispatch(function(){var e=Object(y.a)(v.a.mark(function e(t){var a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(Ce(!0)),e.next=3,X(t);case 3:a=e.sent,t(Te(a)),t(Ce(!1));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}},{key:"render",value:function(){var e=this,t=this.props.wargame.wargameList.length>0;return Object.keys(this.props.dbLoading).every(function(t){return e.props.dbLoading[t]})?r.a.createElement("div",{id:"loading"},r.a.createElement("div",null,r.a.createElement("div",{id:"loader"}))):r.a.createElement("div",{id:"umpire",className:"flex-content-wrapper"},r.a.createElement("div",{className:"flex-content flex-content--fill"},r.a.createElement(Lt,{href:"/client/umpireMenu",class:"link link--secondary link--large"},"Umpire Menu"),r.a.createElement(Lt,{href:"/client/playerUi",disabled:!t,class:Mt()("link","link--secondary","link--large",{"link--disabled":!t})},"Player UI"),!t&&r.a.createElement("p",null,"At least one wargame needed to access player ui")))}}]),t}(n.Component),Wt=Object(m.b)(function(e){return{wargame:e.wargame,dbLoading:e.dbLoading}})(Pt),Ft=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).filterMessages=function(e){var t=e?e.target.value:a.state.searchInput,n=a.props.listData.filter(function(e){return e.title.toLowerCase().indexOf(t.toLowerCase())>-1});a.setState({searchQuery:n,searchInput:e?t:a.state.searchInput})},a.displayControls=function(e){a.setState({activeTitle:e})},a.hideControls=function(){a.setState({activeTitle:!1})},a.state={messageList:a.props.listData,searchQuery:a.props.listData,searchInput:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillUpdate",value:function(e,t,a){var n=S.a.difference(e.listData,this.state.messageList).length;(e.listData.length!==this.state.messageList.length||0!==n&&0===this.state.searchInput.length)&&this.setState({messageList:e.listData}),this.state.searchInput.length>0&&0!==n&&this.filterMessages()}},{key:"setSelectedWargame",value:function(e){this.props.dispatch(function(e){return function(){var t=Object(y.a)(v.a.mark(function t(a){var n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ae(e);case 2:n=t.sent,console.log(n),a(je(n));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}(e)),this.props.dispatch(Ze("/client/gameSetup"))}},{key:"duplicateWargame",value:function(e){var t;this.props.dispatch((t=e,function(){var e=Object(y.a)(v.a.mark(function e(a){var n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le(t);case 2:n=e.sent,a(Te(n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()))}},{key:"deleteWargame",value:function(e){this.props.dispatch(h.open("deleteWargame",e))}},{key:"render",value:function(){var e=this,t=this.state.searchInput?this.state.searchQuery:this.state.messageList;return r.a.createElement("div",{className:"searchlist"},r.a.createElement("input",{type:"text",className:"searchlist-input",key:"search-templates",placeholder:"Search games",onChange:this.filterMessages,value:this.state.searchInput}),r.a.createElement("div",{className:"searchlist-list"},t.map(function(t){return r.a.createElement("span",{className:"searchlist-title",key:t.title,onMouseOver:e.displayControls.bind(e,t.title),onMouseLeave:e.hideControls},t.title,e.state.activeTitle===t.title?r.a.createElement(r.a.Fragment,null,r.a.createElement(kt.a,{icon:Nt.c,onClick:e.setSelectedWargame.bind(e,t.name)}),r.a.createElement(kt.a,{icon:Nt.b,onClick:e.duplicateWargame.bind(e,t.name)}),r.a.createElement(kt.a,{icon:Nt.g,onClick:e.deleteWargame.bind(e,t.name)})):null)})))}}]),t}(n.Component),Ut=Object(m.b)(function(){return{}})(Ft),Gt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).createWargame=function(){a.props.dispatch(Me())},a.clearWargames=function(){a.props.dispatch(Ae())},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"umpire",className:"flex-content-wrapper"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(Lt,{href:"/client",id:"home-btn"},r.a.createElement(kt.a,{icon:Nt.a,size:"2x"}))),r.a.createElement("div",{className:"flex-content flex-content--big flex-content--first"},r.a.createElement(Lt,{href:"/client/umpireMenu/templates",class:"link link--secondary link--large"},"Message Templates"),r.a.createElement(Lt,{href:"/client/umpireMenu/library",class:"link link--secondary link--large"},"Message Library")),r.a.createElement("div",{className:"flex-content flex-content--big flex-content--last"},r.a.createElement("h2",null,"Games"),r.a.createElement(Lt,{href:"/client/gameSetup",class:"link link--noIcon",onClickHandler:this.createWargame},"Create"),r.a.createElement(Lt,{href:"/client/umpireMenu",class:"link link--noIcon link--secondary",onClickHandler:this.clearWargames},"Clear wargames"),r.a.createElement(Ut,{key:"searchlist",listData:this.props.wargame.wargameList})))}}]),t}(n.Component),Vt=Object(m.b)(function(e){return{wargame:e.wargame}})(Gt),Bt=a(23),Ht=a.n(Bt),qt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).saveMessage=function(){var e=a.props.messageTypes.messages.find(function(e){return e._id===a.props.umpireMenu.selectedSchemaID}).details;a.props.dispatch(rt(a.editor.getValue(),Object(O.a)({},e,{_id:a.props.umpireMenu.selectedSchemaID})))},a.editor=null,a.editorPreviewRef=r.a.createRef(),a.state={selectedSchema:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillUpdate",value:function(e,t,a){if(this.editor&&e.umpireMenu.selectedSchemaID!==this.props.umpireMenu.selectedSchemaID&&(this.editor.destroy(),this.editor=null),e.umpireMenu.selectedSchemaID.length>0&&e.messageTypes&&e.messageTypes.messages.length>0){if(this.editor)return;this.editor=new Ht.a(this.editorPreviewRef.current,{schema:e.messageTypes.messages.find(function(t){return t._id===e.umpireMenu.selectedSchemaID}).details,theme:"bootstrap4"})}if(e.messages.messagePreviewId.length>0&&e.messageTypes.messages.length>0&&!e.disabled){var n=e.messages.messages.find(function(t){return t._id.toLowerCase().indexOf(e.messages.messagePreviewId.toLowerCase())>-1});this.editor.setValue(n.details)}this.props.disabled&&this.editor&&this.editor.disable()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"button-wrap"},this.props.disabled?null:r.a.createElement("span",{onClick:this.saveMessage,className:"link"},r.a.createElement(kt.a,{icon:Nt.e}),"Save Message")),r.a.createElement("div",{id:"preview-editor",ref:this.editorPreviewRef}),r.a.createElement("div",{className:"button-wrap"},this.props.disabled?null:r.a.createElement("span",{onClick:this.saveMessage,className:"link"},r.a.createElement(kt.a,{icon:Nt.e}),"Save Message")))}}]),t}(n.Component),$t=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes,selectedSchema:e.selectedSchema,umpireMenu:e.umpireMenu}})(qt),Yt=a(32),Qt=a.n(Yt),zt=r.a.Fragment,Jt=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"createObjItem",value:function(e){return r.a.createElement("span",{key:"objItem--".concat(e[0],"-").concat(e[1]),className:"group-section"},this.deconstructObj(e[1]))}},{key:"createBoolItem",value:function(e){return r.a.createElement("span",{key:"boolItem--".concat(e[0],"-").concat(e[1])},!!e[1]&&e[0])}},{key:"createTimeItem",value:function(e){return r.a.createElement(zt,{key:"dateTime-".concat(e[1])},r.a.createElement("h3",null,e[0]),r.a.createElement("span",null,Qt()(e[1]).format("Do MMMM YYYY, HH:mm")))}},{key:"createStrItem",value:function(e,t){return r.a.createElement("span",{key:"strItem-".concat(e[0],"-").concat(e[1])},r.a.createElement("b",null,e[0],": "),e[1])}},{key:"deconstructArr",value:function(e){var t=this;return r.a.createElement(zt,{key:"".concat(e[0])},r.a.createElement("h3",null,e[0]),e[1].map(function(e){return r.a.createElement("span",{key:"section-".concat(e.name)},t.deconstructObj(e))}))}},{key:"deconstructObj",value:function(e){var t=this;return Object.entries(e).map(function(e,a){return Be.a.object(e[1])?t.createObjItem(e):Be.a.array.of.object(e[1])?t.deconstructArr(e):Be.a.boolean(e[1])?t.createBoolItem(e):Qt()(e[1],Qt.a.ISO_8601,!0).isValid()?t.createTimeItem(e):t.createStrItem(e)})}},{key:"render",value:function(){var e=this;if(!this.props.detail)return!1;var t=this;return Object.entries(this.props.detail).map(function(a,n){return 0===n?r.a.createElement(zt,{key:"from-".concat(a[1])},r.a.createElement("h2",null,a[1]),!!e.props.from&&r.a.createElement("span",{key:"from"},"From: ",e.props.from)):Be.a.object(a[1])?t.createObjItem(a):Be.a.array.of.object(a[1])?t.deconstructArr(a):Be.a.boolean(a[1])?t.createBoolItem(a):Qt()(a[1],Qt.a.ISO_8601,!0).isValid()?t.createTimeItem(a):r.a.createElement(zt,{key:"".concat(a[0],"-").concat(a[1])},r.a.createElement("h3",null,a[0]),r.a.createElement("span",null,a[1]))})}}]),t}(n.Component),Zt=Object(m.b)()(Jt),Kt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).setSelected=function(e){a.props.setSelected(e)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"searchlist"},r.a.createElement("input",{type:"text",className:"searchlist-input",key:"search-templates",placeholder:this.props.placeholder,onChange:this.props.filter,value:this.props.searchQuery}),r.a.createElement("div",{className:"searchlist-list"},this.props.listData.map(function(t){var a=t._id===e.props.selected?"active":null,n=t.details.title,s=Qt()(t.lastUpdated).format("DD/MM/YY");return r.a.createElement("span",{className:Mt()({"searchlist-title":!0,active:a}),href:"#",onClick:e.setSelected.bind(e,t),key:t._id},n," - ",s)})))}}]),t}(n.Component),Xt=Object(m.b)(function(e){return{currentViewURI:e.currentViewURI,umpireMenu:e.umpireMenu}})(Kt),ea=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).setSelectedSchemaId=function(e){switch(a.state.creatorType){case"templates":a.props.dispatch(yt(e._id));break;case"library":a.props.dispatch(yt(e.schema._id)),a.props.dispatch(ot(e._id));break;default:console.log("error")}},a.filterMessages=function(e){var t,n=e?e.target.value:a.state.searchQuery;switch(a.state.creatorType){case"templates":t=a.props.messageTypes.messages.filter(function(e){return e.details.title.toLowerCase().indexOf(n.toLowerCase())>-1});break;case"library":t=a.props.messages.messages.filter(function(e){return e.details.title.toLowerCase().indexOf(n.toLowerCase())>-1});break;default:t=[]}a.setState({messageList:t,searchQuery:n})},a.duplicateTemplate=function(){a.props.dispatch(ft(a.props.umpireMenu.selectedSchemaID))},a.deleteTemplate=function(){a.props.dispatch(h.open("delete"))},a.duplicateMessage=function(){a.props.dispatch(st(a.props.messages.messagePreviewId))},a.deleteMessage=function(){a.props.dispatch(h.open("delete"))};var n=a.props.currentViewURI.split("/")[3];return a.state={searchQuery:"",creatorType:n,messageList:"templates"===n?a.props.messageTypes.messages:a.props.messages.messages},a.buildMessageBoard(),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(yt(""))}},{key:"componentWillReceiveProps",value:function(e,t){0===this.state.searchQuery.length&&this.setState({messageList:"templates"===this.state.creatorType?e.messageTypes.messages:e.messages.messages}),e.messages.messages.length!==this.props.messages.messages.length&&setTimeout(this.filterMessages,1)}},{key:"buildMessageBoard",value:function(){switch(this.state.creatorType){case"templates":this.props.dispatch(vt());break;case"library":this.props.dispatch(function(){var e=Object(y.a)(v.a.mark(function e(t){var a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(at(!0)),e.next=3,Ye();case 3:a=e.sent,t(Xe(a)),t(at(!1));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}}},{key:"createSearchListSection",value:function(){switch(this.state.creatorType){case"templates":return[r.a.createElement(Lt,{href:"/client/messageCreator/create/template",key:"templates",class:"link"},r.a.createElement(kt.a,{icon:Nt.d}),"Create new template"),r.a.createElement(Xt,{key:"searchlist",listData:this.state.messageList,searchQuery:this.state.searchQuery,filter:this.filterMessages,selected:this.props.umpireMenu.selectedSchemaID,setSelected:this.setSelectedSchemaId,placeholder:"Select template"})];case"library":return[r.a.createElement(Lt,{href:"/client/messageCreator/create/message",key:"messages",class:"link"},r.a.createElement(kt.a,{icon:Nt.d}),"Create new Message"),r.a.createElement(Xt,{key:"searchlist",listData:this.state.messageList,searchQuery:this.state.searchQuery,filter:this.filterMessages,selected:this.props.messages.messagePreviewId,setSelected:this.setSelectedSchemaId,placeholder:"Select template"})]}}},{key:"createMessagesActions",value:function(){return this.props.messages.messagePreviewId.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt,{class:"link link--secondary",href:"templates"===this.state.creatorType?"/messageCreator/edit/template":"/messageCreator/edit/message"},r.a.createElement(kt.a,{icon:Nt.c}),"Edit"),r.a.createElement("span",{className:"link link--secondary",onClick:this.duplicateMessage},r.a.createElement(kt.a,{icon:Nt.b}),"Duplicate"),r.a.createElement("span",{className:"link link--secondary",onClick:this.deleteMessage},r.a.createElement(kt.a,{icon:Nt.g}),"Delete")):null}},{key:"createTemplatesActions",value:function(){return this.props.umpireMenu.selectedSchemaID.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt,{class:"link link--secondary",href:"templates"===this.state.creatorType?"/messageCreator/edit/template":"/messageCreator/edit/message"},r.a.createElement(kt.a,{icon:Nt.c}),"Edit"),r.a.createElement("span",{className:"link link--secondary",onClick:this.duplicateTemplate},r.a.createElement(kt.a,{icon:Nt.b}),"Duplicate"),r.a.createElement("span",{className:"link link--secondary",onClick:this.deleteTemplate},r.a.createElement(kt.a,{icon:Nt.g}),"Delete")):null}},{key:"render",value:function(){return r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(Lt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(kt.a,{icon:Nt.a,size:"2x"}))),r.a.createElement("h1",null,"Message ",this.state.creatorType),r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{id:"selection",className:"flex-content"},this.createSearchListSection()),r.a.createElement("div",{id:"preview",className:"flex-content flex-content--big"},r.a.createElement("p",{className:"heading--sml"},"Preview"),"templates"===this.state.creatorType?r.a.createElement($t,{id:"preview",disabled:!0,previewForm:!0}):r.a.createElement("div",{className:"message-preview"},r.a.createElement(Zt,{detail:this.props.messages.messagePreview.details}))),r.a.createElement("div",{id:"function",className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml"},"Actions"),"templates"===this.state.creatorType?this.createTemplatesActions():this.createMessagesActions())))}}]),t}(n.Component),ta=Object(m.b)(function(e){return{messageTypes:e.messageTypes,messages:e.messages,currentViewURI:e.currentViewURI,umpireMenu:e.umpireMenu}})(ea),aa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).saveMessage=function(){a.props.dispatch(it(a.editor.getValue(),a.props.messages.messagePreviewId))},a.editor=null,a.editorPreviewRef=r.a.createRef(),a.state={selectedSchema:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillUpdate",value:function(e,t,a){if(this.editor&&e.umpireMenu.selectedSchemaID!==this.props.umpireMenu.selectedSchemaID&&(this.editor.destroy(),this.editor=null),e.messages.messagePreviewId.length>0||e.umpireMenu.selectedSchemaID.length>0){if(this.editor)return;this.editor=new Ht.a(this.editorPreviewRef.current,{schema:e.messages.messagePreview.schema,theme:"bootstrap4"})}e.messages.messagePreview.details&&this.editor.setValue(e.messages.messagePreview.details),this.props.disabled&&this.editor&&this.editor.disable()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"button-wrap"},this.props.disabled?null:r.a.createElement("span",{onClick:this.saveMessage,className:"link"},r.a.createElement(kt.a,{icon:Nt.e}),"Save Message")),r.a.createElement("div",{id:"preview-editor",ref:this.editorPreviewRef}),r.a.createElement("div",{className:"button-wrap"},this.props.disabled?null:r.a.createElement("span",{onClick:this.saveMessage,className:"link"},r.a.createElement(kt.a,{icon:Nt.e}),"Save Message")))}}]),t}(n.Component),na=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes,selectedSchema:e.selectedSchema,umpireMenu:e.umpireMenu}})(aa),ra=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).filterMessages=function(e){var t=e.target.value,n=a.props.messages.messages.filter(function(e){return e.title.toLowerCase().indexOf(t.toLowerCase())>-1});a.setState({messageList:n,searchInput:t.toLowerCase()})},a.state={messageToEdit:a.props.messages.messagePreviewId,messageList:a.props.messages.messages,searchInput:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(vt())}},{key:"componentWillReceiveProps",value:function(e,t){this.props.messages.messages.length!==e.messages.messages.length&&this.setState({messageToEdit:e.messages.messagePreviewId,messageList:e.messages.messages})}},{key:"render",value:function(){return r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(Lt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(kt.a,{icon:Nt.a,size:"2x"}))),r.a.createElement("h1",null,"Message library"),r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{id:"preview",className:"flex-content flex-content--solo-item"},r.a.createElement(na,{id:"preview",disabled:!1}))))}}]),t}(n.Component),sa=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes}})(ra),ia=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).filterMessages=function(e){var t=e.target.value,n=a.props.messageTypes.messages.filter(function(e){return e.details.title.toLowerCase().indexOf(t.toLowerCase())>-1});a.setState({messageList:n,searchQuery:t})},a.setSelectedSchemaId=function(e){a.props.dispatch(yt(e._id))},a.state={messageList:a.props.messageTypes.messages,searchQuery:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(nt()),this.props.dispatch(vt())}},{key:"componentWillReceiveProps",value:function(e,t){this.props.messageTypes.messages.length!==e.messageTypes.messages.length&&this.setState({messageList:e.messageTypes.messages})}},{key:"render",value:function(){return r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(Lt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(kt.a,{icon:Nt.a,size:"2x"}))),r.a.createElement("h1",null,"Message library"),r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{id:"selection",className:"flex-content"},r.a.createElement(Xt,{key:"search-templates",listData:this.state.messageList,searchQuery:this.state.searchQuery,filter:this.filterMessages,selected:this.props.umpireMenu.selectedSchemaID,setSelected:this.setSelectedSchemaId,placeholder:"Select template"})),r.a.createElement("div",{id:"preview",className:"flex-content flex-content--big"},r.a.createElement($t,{id:"preview",disabled:!1}))))}}]),t}(n.Component),ca=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes,umpireMenu:e.umpireMenu,currentViewURI:e.currentViewURI}})(ia),oa=a(31),la=a(88),ua=a(165),pa=a(166),ma=a(167),da=a(168);function ha(e){this.jsonEditor=null,this.renderZone="string"===typeof e?document.getElementById(e):e.current}function fa(e){ha.call(this,e)}function ga(e){ha.call(this,e);var t=function(e){if(e.matches('div[data-schemapath$=".properties"] > h3 > div > button.json-editor-btntype-properties')){var t=e.parentElement.parentElement.parentElement.querySelector("h3 > span");if(t&&"properties"===t.innerText)return!0}return!1};this.observer=new MutationObserver(function(e,a){var n=!0,r=!1,s=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){i.value.addedNodes.forEach(function(e){if(1===e.nodeType)if(t(e))e.querySelector("span").innerText="Add/Remove";else if(e.matches("button.json-editor-btntype-properties")){var a=e.querySelector("i");a.classList.remove("fa-pen"),a.classList.add("fa-cog"),e.querySelector("span").innerText=""}})}}catch(o){r=!0,s=o}finally{try{n||null==c.return||c.return()}finally{if(r)throw s}}}),this.observer.observe(this.renderZone,{childList:!0,subtree:!0})}ha.prototype.destroy=function(){this.jsonEditor&&(this.jsonEditor.destroy(),this.jsonEditor=null)},ha.prototype.updateSchema=function(e){this.destroy(),this.jsonEditor=new Ht.a(this.renderZone,{schema:e})},ha.prototype.validate=function(){return this.jsonEditor.validate()},ha.prototype.getJSON=function(){return this.jsonEditor.getValue()},fa.prototype=Object.create(ha.prototype),Object.defineProperty(fa.prototype,"constructor",{value:fa,enumerable:!1,writable:!0}),fa.prototype.updateSchema=function(e){this.destroy(),this.jsonEditor=new Ht.a(this.renderZone,{schema:e,no_additional_properties:!0})},ga.prototype=Object.create(ha.prototype),Object.defineProperty(ga.prototype,"constructor",{value:ga,enumerable:!1,writable:!0}),ga.prototype.updateSchema=function(e){this.destroy();this.jsonEditor=new Ht.a(this.renderZone,{schema:e,custom_validators:[function(e,t,a){var n=[];return null!==t&&"integer"===t.type&&"range"===t.format&&("undefined"!==typeof t.minimum&&"undefined"!==typeof t.maximum||n.push({path:a,property:"format",message:"The range format requires that you specify both minimum and maximum properties, too."})),n},function(e,t,a){var n=[];return null===t||"integer"!==t.type&&"number"!==t.type||"undefined"!==typeof t.minimum&&"undefined"!==typeof t.minimum&&t.minimum>t.maximum&&n.push({path:a,property:"maximum",message:"The maximum value must be greater than or equal than the minimum value."}),n}]});this.jsonEditor.on("ready",function(){var e=this.root.getButton("Save","save","Save"),t=this.root.theme.getHeaderButtonHolder();t.appendChild(e),this.root.header.parentNode.insertBefore(t,this.root.header.nextSibling);var a=this;e.addEventListener("click",function(e){e.preventDefault();var t=a.getValue(),n=new Blob([JSON.stringify(t,null,2)],{type:"application/json;charset=utf-8"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,"schema.json");else{var r=document.createElement("a");r.download="schema.json",r.href=URL.createObjectURL(n),r.dataset.downloadurl=["text/plain",r.download,r.href].join(":"),r.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1}))}},!1)})};var Ea=function(e){function t(e,a){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e,a))).schemaEditor=null,n.editorBox=r.a.createRef(),n.onChange=n.onChange.bind(Object(oa.a)(Object(oa.a)(n))),n.updateEditor=n.updateEditor.bind(Object(oa.a)(Object(oa.a)(n))),n.saved="",n.value=n.props.defaultValue,n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"onChange",value:function(e,t){var a=this.schemaEditor.validate();console.log(a),a.length?alert("Invalid schema"):this.props.onChange&&(this.value=this.schemaEditor.jsonEditor.getValue(),this.props.onChange(this.schemaEditor.getJSON()))}},{key:"componentDidMount",value:function(){this.schemaEditor=new ga(this.editorBox),this.updateEditor(this.props.schema,this.props.options)}},{key:"componentWillReceiveProps",value:function(e){var t=e.schema,a=e.options;this.updateEditor(t,a)}},{key:"updateEditor",value:function(e,t){try{var a=JSON.stringify(e);a===this.save&&t.counter===this.props.options.counter||(Ht.a.defaults.options.object_layout=t.layout,Ht.a.defaults.options=Object(O.a)({},Ht.a.defaults.options,t.booleanOptions),this.save=a,this.schemaEditor.updateSchema(e),this.schemaEditor.jsonEditor.setValue(this.value),this.schemaEditor.jsonEditor.on("change",this.onChange))}catch(n){alert("Invalid json schema"),console.log(n)}}},{key:"render",value:function(){return r.a.createElement(ua.a,null,r.a.createElement(pa.a,null,"Schema Editor"),r.a.createElement(ma.a,null,r.a.createElement("div",{id:"schema-editor",ref:this.editorBox})),r.a.createElement(da.a,null))}}]),t}(n.Component),va=function(e){function t(e,a){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e,a))).previewBox=r.a.createRef(),n.editorPreview=null,n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.editorPreview=new fa(this.previewBox)}},{key:"componentWillReceiveProps",value:function(e){var t=e.schema;this.editorPreview.destroy(),null!==t&&this.editorPreview.updateSchema(t)}},{key:"render",value:function(){return r.a.createElement(ua.a,null,r.a.createElement(pa.a,null,"Editor Preview"),r.a.createElement(ma.a,null,r.a.createElement("div",{id:"editor-preview",ref:this.previewBox})),r.a.createElement(da.a,null,"The Editor Preview will be updated as you make changes in the Schema Editor"))}}]),t}(n.Component),ya=(a(122),function(e){function t(e,a){var n;return Object(c.a)(this,t),n=Object(l.a)(this,Object(u.a)(t).call(this,e,a)),Ht.a.defaults.options.iconlib="fontawesome5",Ht.a.defaults.options.theme="bootstrap4",n.updateMetaSchema=n.updateMetaSchema.bind(Object(oa.a)(Object(oa.a)(n))),n.updatePreviewSchema=n.updatePreviewSchema.bind(Object(oa.a)(Object(oa.a)(n))),n.updateOptions=n.updateOptions.bind(Object(oa.a)(Object(oa.a)(n))),n.schemaEditor=null,n.editorPreview=null,n.defaultValue={type:"object",properties:{title:{type:"string"},Date:{type:"string",format:"datetime-local"},Status:{type:"string",enum:["Minor","Major","Critical"]},Description:{type:"string",format:"textarea"}},title:"Machinery Failure",format:"grid"},n.props.schemaId&&(n.defaultValue=n.props.messageTypes.messages.find(function(e){return e._id===n.props.schemaId}).details),n.state={metaSchema:la,previewSchema:null,options:{layout:Ht.a.defaults.options.object_layout,booleanOptions:{}}},n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"updatePreviewSchema",value:function(e){console.log("preview update"),this.setState({previewSchema:e}),this.props.dispatch(bt(e))}},{key:"updateOptions",value:function(e){console.log("options update"),this.setState({options:e})}},{key:"updateMetaSchema",value:function(e){console.log("editor update"),this.setState({metaschema:e})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"flex-content flex-content--left50"},r.a.createElement(Ea,{schema:this.state.metaSchema,onChange:this.updatePreviewSchema,options:this.state.options,defaultValue:this.defaultValue})),r.a.createElement("div",{className:"flex-content flex-content--right50"},r.a.createElement(va,{schema:this.state.previewSchema})))}}]),t}(n.Component)),ba=Object(m.b)(function(e){return{umpireMenu:e.umpireMenu}})(ya),wa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).filterMessages=function(e){var t=e.target.value,n=a.props.messageTypes.messages.filter(function(e){return e.details.title.toLowerCase().indexOf(t.toLowerCase())>-1});a.setState({messageList:n,searchInput:t.toLowerCase()})},a.updateSchema=function(){a.props.dispatch(gt(a.props.umpireMenu.previewSchema,a.props.umpireMenu.selectedSchemaID))},a.state={messageList:a.props.messageTypes.messages,searchInput:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(nt()),this.props.dispatch(vt())}},{key:"componentWillReceiveProps",value:function(e,t){this.props.messageTypes.messages.length!==e.messageTypes.messages.length&&this.setState({messageList:e.messageTypes.messages})}},{key:"render",value:function(){return r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(Lt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(kt.a,{icon:Nt.a,size:"2x"}))),r.a.createElement("h1",null,"Message template"),r.a.createElement("div",{className:"button-wrap"},r.a.createElement("span",{onClick:this.updateSchema,className:"link"},r.a.createElement(kt.a,{icon:Nt.e}),"Save Message")),r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement(ba,{schemaId:this.props.umpireMenu.selectedSchemaID,messageTypes:this.props.messageTypes})),r.a.createElement("div",{className:"button-wrap"},r.a.createElement("span",{onClick:this.updateSchema,className:"link"},r.a.createElement(kt.a,{icon:Nt.e}),"Save Message")))}}]),t}(n.Component),Sa=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes,currentViewURI:e.currentViewURI,umpireMenu:e.umpireMenu}})(wa),Oa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).saveSchema=function(){a.props.dispatch(ht(a.props.umpireMenu.previewSchema))},a.state={messageList:a.props.messageTypes.messages,searchInput:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(nt()),this.props.dispatch(vt())}},{key:"componentWillReceiveProps",value:function(e,t){this.props.messageTypes.messages.length!==e.messageTypes.messages.length&&this.setState({messageList:e.messageTypes.messages})}},{key:"render",value:function(){return r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(Lt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(kt.a,{icon:Nt.a,size:"2x"}))),r.a.createElement("h1",null,"Message template"),r.a.createElement("div",{className:"button-wrap"},r.a.createElement("span",{onClick:this.saveSchema,className:"link"},r.a.createElement(kt.a,{icon:Nt.e}),"Save Message")),r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement(ba,null)),r.a.createElement("div",{className:"button-wrap"},r.a.createElement("span",{onClick:this.saveSchema,className:"link"},r.a.createElement(kt.a,{icon:Nt.e}),"Save Message")))}}]),t}(n.Component),_a=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes,currentViewURI:e.currentViewURI,umpireMenu:e.umpireMenu}})(Oa),Ta=a(22),ja=a(169),Na=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){a.props.updateStore(e.target.value)},a.state={type:a.props.options.numInput?"number":"text"},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.validInput?"":"invalid-input";return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{className:e,id:this.props.id?this.props.id:null,type:this.state.type,onChange:this.onChange,value:this.props.data?this.props.data:""}))}}]),t}(n.Component),ka=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(e){console.log(e.target.value),a.props.updateStore(e.target.value)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("select",{disabled:this.props.disabled,value:this.props.data?this.props.data:"placeholder",onChange:this.onChange,className:this.props.className||null},r.a.createElement("option",{value:"placeholder",disabled:!0},this.props.placeholder),this.props.selectOptions.map(function(e,t){return r.a.createElement("option",{key:"".concat(e.value).concat(e.option),value:e.value},e.option)}))}}]),t}(n.Component),Ca=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.className?this.props.className+" flex-content flex-content--row":"flex-content flex-content--row";return r.a.createElement("div",{className:e},this.props.children)}}]),t}(n.Component),Ma=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(e){a.props.updateStore(e.target.value)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("textarea",{value:this.props.data,onChange:this.onChange,style:{resize:"none"}})}}]),t}(n.Component),Aa=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).updateDescription=function(e){a.props.dispatch(ye({gameDescription:e}))},a.updateSpatialRepresentation=function(e){a.props.dispatch(ye({spatialRepresentation:e}))},a.updatePlanningInterval=function(e){a.props.dispatch(ye({planningInterval:e}))},a.updateReplayInterval=function(e){a.props.dispatch(ye({replayInterval:e}))},a.updateTurnStrategy=function(e){a.props.dispatch(ye({turnStrategy:e}))},a.saveSettings=function(){var e=a.props.wargame.currentTab;a.props.dispatch(Re(a.props.wargame.currentWargame,a.props.wargame.data[e]))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"flex-content-wrapper settingsTab"},r.a.createElement("div",{className:"flex-content flex-content--left50"},r.a.createElement("p",{className:"heading--sml"},"Game description & objectives"),r.a.createElement(Ma,{updateStore:this.updateDescription,data:this.props.wargame.data[this.props.wargame.currentTab].gameDescription})),r.a.createElement("div",{className:"flex-content flex-content--right50"},r.a.createElement(Ca,{className:"flex-content--rowend"},r.a.createElement("span",{className:"link link--noIcon",onClick:this.saveSettings},"save Overview")),r.a.createElement(Ca,null,r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml"},"Spatial Representation")),r.a.createElement("div",{className:"flex-content flex-content--fill"},r.a.createElement(ka,{updateStore:this.updateSpatialRepresentation,selectOptions:[{value:"opt1",option:"opt1"},{value:"opt2",option:"opt2"},{value:"opt3",option:"opt3"}],placeholder:"Select spatial representation",data:this.props.wargame.data[this.props.wargame.currentTab].spatialRepresentation}))),r.a.createElement(Ca,null,r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml"},"Planning Interval")),r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement(Na,{updateStore:this.updatePlanningInterval,options:{numInput:!0},data:this.props.wargame.data[this.props.wargame.currentTab].planningInterval,validInput:!0})),r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml heading--mleft"},"min."))),r.a.createElement(Ca,null,r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml"},"Replay interval")),r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement(Na,{updateStore:this.updateReplayInterval,options:{numInput:!0},data:this.props.wargame.data[this.props.wargame.currentTab].replayInterval,validInput:!0})),r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml heading--mleft"},"min."))),r.a.createElement(Ca,null,r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml"},"Turn Strategy")),r.a.createElement("div",{className:"flex-content flex-content--fill"},r.a.createElement(ka,{updateStore:this.updateTurnStrategy,selectOptions:[{value:"opt1",option:"opt1"},{value:"opt2",option:"opt2"},{value:"opt3",option:"opt3"}],placeholder:"Not implemented yet",data:this.props.wargame.data[this.props.wargame.currentTab].turnStrategy})))))}}]),t}(n.Component),Ia=Object(m.b)(function(e){return{wargame:e.wargame}})(Aa),xa=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).setSelected=function(e){a.props.setSelected(e)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"list"},!!this.props.filter&&r.a.createElement("input",{type:"text",className:"list-input",key:"search-templates",placeholder:this.props.placeholder,onChange:this.props.filter,value:this.props.searchQuery}),r.a.createElement("div",{className:"list-list"},this.props.listData.map(function(t){var a=t===e.props.selected?"active":"";return r.a.createElement("span",{href:"#",onClick:e.setSelected.bind(e,t),key:t,className:Mt()({"list-title":!0,active:a})},t)})))}}]),t}(n.Component),Ra=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("span",{className:"group-item",key:this.props.children},this.props.children,r.a.createElement(kt.a,{icon:Nt.f}))}}]),t}(n.Component);function Da(e,t){return t.every(function(t){return t!==e})}var La=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).createForce=function(){var e="force-"+T.a.time();a.props.dispatch(Se(e)),a.props.dispatch(be(e));var t=A;t.forceName=e,a.props.dispatch(De(a.props.wargame.currentWargame,e,t,e)),a.setState({newForceName:null})},a.setSelected=function(e){a.props.dispatch(be(e))},a.updateOverview=function(e){a.props.dispatch(_e(e))},a.saveForce=function(){var e=a.props.wargame.currentTab,t=a.props.wargame.data[e].selectedForce,n=a.props.wargame.data[e].forces.find(function(e){return e.forceName===t});if("string"===typeof a.state.newForceName&&a.state.newForceName.length>0){if(!a.checkUnique())return;a.props.dispatch(De(a.props.wargame.currentWargame,a.state.newForceName,n,t))}null===a.state.newForceName?a.props.dispatch(De(a.props.wargame.currentWargame,t,n,t)):0===a.state.newForceName.length&&alert("no channel name")},a.deleteForce=function(){var e=a.props.wargame.currentTab,t=a.props.wargame.data[e].selectedForce;a.props.dispatch(We(a.props.wargame.currentWargame,t))},a.updateForceName=function(e){a.setState({newForceName:e})},a.state={newForceName:null,forcesList:a.props.wargame.data[a.props.wargame.currentTab].forces},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this.props.wargame.data[this.props.wargame.currentTab].selectedForce,n=e.wargame.data[e.wargame.currentTab].selectedForce,r=this.props.wargame.data[this.props.wargame.currentTab].forces,s=e.wargame.data[e.wargame.currentTab].forces;r.length===s.length&&a===n||this.setState({forcesList:e.wargame.data[e.wargame.currentTab].forces}),a!==n&&this.setState({newForceName:null})}},{key:"checkUnique",value:function(){var e=this.props.wargame.currentTab,t=this.props.wargame.data[e].selectedForce,a=this.props.wargame.data[e].forces.map(function(e){return e.forceName});return a=S.a.pull(a,t),!!Da(this.state.newForceName,a)||(this.props.dispatch(ge("Force name is not unique.","warning")),!1)}},{key:"createForceEditor",value:function(){var e=this.props.wargame.currentTab,t=this.props.wargame.data[e].selectedForce,a="string"===typeof this.state.newForceName?this.state.newForceName:t;return r.a.createElement("div",{className:"flex-content--fill forcesTab"},r.a.createElement(Na,{id:"channel-editable",updateStore:this.updateForceName,options:{numInput:!1},data:a,validInput:this.props.wargame.validation.validForceName}),r.a.createElement("span",{className:"link link--noIcon",onClick:this.saveForce},"save force"),r.a.createElement("span",{className:"link link--secondary",onClick:this.deleteForce},r.a.createElement(kt.a,{icon:Nt.g}),"Delete"),r.a.createElement("span",{className:"link link--secondary link--noIcon link--disabled"},"Change icon"),r.a.createElement("p",{className:"heading--sml"},"Overview & Objectives"),r.a.createElement(Ma,{updateStore:this.updateOverview,data:this.props.wargame.data[e].forces.find(function(e){return e.forceName===t}).overview}),r.a.createElement("p",{className:"heading--sml"},"Roles"),r.a.createElement("span",{className:"link link--secondary link--noIcon link--disabled"},"Add a new role"),r.a.createElement("div",{className:"flex-content"},this.props.wargame.data[e].forces.find(function(e){return e.forceName===t}).roles.map(function(e){return r.a.createElement(Ra,{key:e},e)})))}},{key:"render",value:function(){var e=this.props.wargame.currentTab,t=this.props.wargame.data[e].selectedForce;return r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{className:"flex-content"},r.a.createElement("span",{className:"link link--noIcon",onClick:this.createForce},"Add a new force"),r.a.createElement(xa,{listData:this.state.forcesList.map(function(e){return e.forceName}),setSelected:this.setSelected,selected:t})),t?this.createForceEditor():null)}}]),t}(n.Component),Pa=Object(m.b)(function(e){return{messages:e.messages,wargame:e.wargame}})(La),Wa=a(46),Fa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).updateSubscriptionForce=function(e){a.setState({editSubscriptionForce:e})},a.updateSubscriptionRole=function(e){a.setState({editSubscriptionRole:e})},a.updateSubscriptionTemplates=function(e){a.setState({editSubscriptionTemplates:e})},a.updateChannel=function(){var e={force:a.state.editSubscriptionForce.label,role:a.state.editSubscriptionRole.label,templates:a.state.editSubscriptionTemplates};a.props.updateRecipient(a.state.subscriptionId,e),a.props.cancelEdit()},a.state={subscriptionId:a.props.data.subscriptionId,editSubscriptionForce:{value:a.props.data.force,label:a.props.data.force},editSubscriptionRole:{value:a.props.data.role,label:a.props.data.role},editSubscriptionTemplates:a.props.data.templates},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(Wa.a,{value:this.state.editSubscriptionForce,options:this.props.forceOptions,onChange:this.updateSubscriptionForce})),r.a.createElement("td",null,r.a.createElement(Wa.a,{value:this.state.editSubscriptionRole,options:this.props.roleOptions,onChange:this.updateSubscriptionRole})),r.a.createElement("td",null,r.a.createElement(Wa.a,{value:this.state.editSubscriptionTemplates,options:this.props.templateOptions,onChange:this.updateSubscriptionTemplates,isMulti:!0})),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-action btn-action--secondary",onClick:this.updateChannel},"Save")))}}]),t}(n.Component),Ua=Object(m.b)()(Fa),Ga=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).cancelEdit=function(){a.setState({subscriptionToEdit:""})},a.updateRecipient=function(e,t){a.props.dispatch(ke(e,t))},a.setSelectedForce=function(e){a.setState({selectedForce:e})},a.setSelectedRole=function(e){a.setState({selectedRole:e})},a.setSelectedTemplate=function(e){a.setState({selectedTemplates:e})},a.addToChannel=function(){if(a.state.selectedTemplates.length>0){var e={force:a.state.selectedForce.value,role:a.state.selectedRole.value,templates:a.state.selectedTemplates};a.props.dispatch(Ne(e)),a.setState({selectedForce:{value:null,label:null},selectedRole:{value:null,label:null},selectedTemplates:[]})}},a.clearChannelData=function(){a.setState({selectedForce:{value:null,label:null},selectedRole:{value:null,label:null},selectedTemplates:[]})};var n=a.props.wargame.data.forces.forces.map(function(e){return{value:e.forceName,label:e.forceName}}),r=a.props.messageTypes.messages.map(function(e){return{value:e._id,label:e.title}});return a.state={selectedForce:{value:null,label:null},forceOptions:n,selectedRole:{value:null,label:null},roleOptions:[],selectedTemplates:[],templateOptions:r,subscriptionToEdit:null,editSubscriptionForce:"",editSubscriptionRole:"",editSubscriptionTemplates:[]},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillUpdate",value:function(e,t,a){if(null!==t.selectedForce.value&&this.state.selectedForce.value!==t.selectedForce.value){var n=[];this.props.wargame.data.forces.forces.find(function(e){return e.forceName===t.selectedForce.value}).roles.forEach(function(e){n.push({value:e,label:e})}),this.setState({roleOptions:n})}}},{key:"componentWillReceiveProps",value:function(e,t){this.props.wargame.data.channels.selectedChannel!==e.wargame.data.channels.selectedChannel&&this.setState({selectedForce:{value:null,label:null},selectedRole:{value:null,label:null},selectedTemplates:[]})}},{key:"createRow",value:function(e,t){var a=[];for(var n in e)if("subscriptionId"!==n){var s="";if("string"!==typeof e[n])for(var i=0;i<e[n].length;i++){s+=e[n][i].label,i!==e[n].length-1&&(s+=", ")}else s=e[n];a.push(r.a.createElement("td",{key:"".concat(s).concat(t)},s))}return a.push(r.a.createElement("td",{key:"edit-delete".concat(t)},r.a.createElement(kt.a,{icon:Nt.g,onClick:this.removeSubscription.bind(this,e.subscriptionId)}),r.a.createElement(kt.a,{icon:Nt.c,onClick:this.editSubscription.bind(this,e.subscriptionId)}))),r.a.createElement("tr",{key:"row-".concat(t)},a)}},{key:"removeSubscription",value:function(e){var t;this.props.dispatch((t=e,{type:d.REMOVE_RECIPIENT,payload:t}))}},{key:"editSubscription",value:function(e){this.setState({subscriptionToEdit:e})}},{key:"render",value:function(){var e=this,t=this.state.selectedTemplates.length>0;return r.a.createElement("div",{className:"flex-content"},r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Force"),r.a.createElement("th",null,"Roles"),r.a.createElement("th",null,"Templates"))),r.a.createElement("tbody",null,this.props.data.map(function(t,a){return t.subscriptionId===e.state.subscriptionToEdit?r.a.createElement(Ua,{key:t.subscriptionId,data:t,forceOptions:e.state.forceOptions,roleOptions:e.state.roleOptions,templateOptions:e.state.templateOptions,cancelEdit:e.cancelEdit,updateRecipient:e.updateRecipient}):e.createRow(t,a)}),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(Wa.a,{value:this.state.selectedForce,options:this.state.forceOptions,onChange:this.setSelectedForce})),r.a.createElement("td",null,r.a.createElement(Wa.a,{value:this.state.selectedRole,options:this.state.roleOptions,onChange:this.setSelectedRole,isDisabled:!this.state.selectedForce.value})),r.a.createElement("td",null,r.a.createElement(Wa.a,{value:this.state.selectedTemplates,options:this.state.templateOptions,onChange:this.setSelectedTemplate,isDisabled:!this.state.selectedRole.value,isMulti:!0})),r.a.createElement("td",null,r.a.createElement(kt.a,{icon:Nt.h,onClick:this.clearChannelData}),r.a.createElement(kt.a,{icon:Nt.d,className:Mt()({"btn--disabled":!t}),onClick:this.addToChannel}))))))}}]),t}(n.Component),Va=Object(m.b)(function(e){return{wargame:e.wargame,messageTypes:e.messageTypes}})(Ga),Ba=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).createChannel=function(){var e="channel-"+T.a.time();a.props.dispatch(we(e)),a.props.dispatch(Oe(e));var t=I;t.channelName=e,a.props.dispatch(Le(a.props.wargame.currentWargame,e,t,e))},a.setSelected=function(e){a.props.dispatch(Oe(e))},a.filterChannels=function(e){var t=e.target.value,n=a.props.wargame.data[a.props.wargame.currentTab].channels;a.setState({channelList:n.filter(function(e){return e.channelName.toLowerCase().indexOf(t.toLowerCase())>-1}),searchQuery:t})},a.deleteChannel=function(){var e=a.props.wargame.currentTab,t=a.props.wargame.data[e].selectedChannel;a.props.dispatch(Pe(a.props.wargame.currentWargame,t))},a.updateChannelName=function(e){a.setState({newChannelName:e})},a.saveChannel=function(){var e=a.props.wargame.currentTab,t=a.props.wargame.data[e].selectedChannel,n=a.props.wargame.data[e].channels.find(function(e){return e.channelName===t});if("string"===typeof a.state.newChannelName&&a.state.newChannelName.length>0){if(!a.checkUnique())return;a.props.dispatch(Le(a.props.wargame.currentWargame,a.state.newChannelName,n,t))}null===a.state.newChannelName?a.props.dispatch(Le(a.props.wargame.currentWargame,t,n,t)):0===a.state.newChannelName.length&&alert("no channel name")},a.state={channelList:a.props.wargame.data[a.props.wargame.currentTab].channels,searchQuery:"",newChannelName:null},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this.props.wargame.data[this.props.wargame.currentTab].selectedChannel,n=e.wargame.data[e.wargame.currentTab].selectedChannel,r=this.props.wargame.data[this.props.wargame.currentTab].channels,s=e.wargame.data[e.wargame.currentTab].channels;r.length===s.length&&a===n||this.setState({channelList:e.wargame.data[e.wargame.currentTab].channels}),a!==n&&this.setState({newChannelName:null})}},{key:"checkUnique",value:function(){var e=this.props.wargame.currentTab,t=this.props.wargame.data[e].selectedChannel,a=this.props.wargame.data[e].channels.map(function(e){return e.channelName});return a=S.a.pull(a,t),!!Da(this.state.newChannelName,a)||(this.props.dispatch(ge("Channel name is not unique.","warning")),!1)}},{key:"createChannelEditor",value:function(){var e=this.props.wargame.currentTab,t=this.props.wargame.data[e].selectedChannel,a="string"===typeof this.state.newChannelName?this.state.newChannelName:t;return r.a.createElement("div",{className:"flex-content--fill channelsTab"},r.a.createElement("div",{className:"flex-content--row"},r.a.createElement(Na,{id:"channel-editable",updateStore:this.updateChannelName,options:{numInput:!1},data:a,validInput:this.props.wargame.validation.validChannelName}),r.a.createElement("span",{className:"link link--noIcon",onClick:this.saveChannel},"save channel"),r.a.createElement("span",{className:"link link--secondary",onClick:this.deleteChannel},r.a.createElement(kt.a,{icon:Nt.g}),"Delete")),r.a.createElement("p",{className:"heading--sml"},"Participants and messages"),r.a.createElement(Va,{data:this.props.wargame.data[e].channels.find(function(e){return e.channelName===t}).participants}))}},{key:"render",value:function(){var e=this.props.wargame.currentTab,t=this.props.wargame.data[e].selectedChannel;return r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{className:"flex-content"},r.a.createElement("span",{className:"link link--noIcon",onClick:this.createChannel},"Add channel"),r.a.createElement(xa,{listData:this.state.channelList.map(function(e){return e.channelName}),filter:this.filterChannels,searchQuery:this.state.searchQuery,setSelected:this.setSelected,selected:t,placeholder:"Search channels"})),t?this.createChannelEditor():null)}}]),t}(n.Component),Ha=Object(m.b)(function(e){return{messages:e.messages,wargame:e.wargame}})(Ba);var qa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).changeTab=function(e){a.setState({activeTab:e}),a.props.setCurrentTab(e)},a.state={value:0,activeTab:Object.keys(a.props.tabs)[0],tabs:Object.keys(a.props.tabs),invalidFields:[]},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.setCurrentTab(Object.keys(this.props.tabs)[0])}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"tab-nav"},this.state.tabs.map(function(t,a){return r.a.createElement("li",{key:t,onClick:e.changeTab.bind(e,e.state.tabs[a]),className:Mt()({"active-tab":t===e.state.activeTab})},t)})),r.a.createElement("div",{className:"flex-content-margin"},this.state.activeTab===this.state.tabs[0]&&r.a.createElement(Ia,null),this.state.activeTab===this.state.tabs[1]&&r.a.createElement(Pa,null),this.state.activeTab===this.state.tabs[2]&&r.a.createElement(Ha,null)))}}]),t}(n.Component),$a=Object(m.b)(function(e){return{wargame:e.wargame}})(Object(Ta.a)(function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper}}})(qa)),Ya=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"progress"},this.props.children)}}]),t}(n.Component),Qa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).setCurrentTab=function(e){a.props.dispatch(ve(e))},a.updateWargameTitle=function(e){a.setState({newWargameName:e})},a.saveWargame=function(){var e=a.props.wargame.wargameList.map(function(e){return e.title});e=S.a.pull(e,a.props.wargame.wargameTitle),Da(a.state.newWargameName,e)?a.checkWargameNameSaveable()&&a.checkAllValid()&&("string"===typeof a.state.newWargameName&&a.state.newWargameName.length>0&&a.props.dispatch(xe(a.props.wargame.currentWargame,a.state.newWargameName)),null!==a.state.newWargameName&&0!==a.state.newWargameName.length||alert("no channel name")):a.props.dispatch(ge("Wargame name is not unique.","warning"))},a.checkWargameNameSaveable=function(){return a.state.newWargameName!==a.props.wargame.wargameTitle&&(null!==a.state.newWargameName&&0!==a.state.newWargameName.length)},a.checkAllValid=function(){return Object.values(a.props.wargame.validation).every(function(e){return!0===e})},a.state={newWargameName:null},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(vt())}},{key:"createIndicators",value:function(){var e=this;return Object.entries(this.props.wargame.data).map(function(t){var a=e.props.wargame.currentTab===parseInt(t[0]),n=t[1].complete;return r.a.createElement("div",{key:t[0],className:Mt()("progress-indicator",{"progress-indicator--active":a,"progress-indicator--complete":n})})})}},{key:"render",value:function(){var e="string"===typeof this.state.newWargameName?this.state.newWargameName:this.props.wargame.wargameTitle;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"view-wrapper view-wrapper-gamesetup"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(Lt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(kt.a,{icon:Nt.a,size:"2x"}))),r.a.createElement("div",{className:"flex-content-wrapper flex-content-wrapper--distribute",id:"game-setup-head"},r.a.createElement("div",{className:"flex-content flex-content--row"},r.a.createElement(Na,{id:"title-editable",updateStore:this.updateWargameTitle,options:{numInput:!1},data:e,validInput:this.props.wargame.validation.validWargameName}),!!this.checkWargameNameSaveable()&&r.a.createElement(kt.a,{className:"savewargame-icon",icon:Nt.e,onClick:this.saveWargame,size:"2x"})),r.a.createElement(Ya,null,this.createIndicators())),r.a.createElement($a,{tabs:this.props.wargame.data,setCurrentTab:this.setCurrentTab})))}}]),t}(n.Component),za=Object(m.b)(function(e){return{wargame:e.wargame}})(Qa),Ja=a(172),Za=a(171),Ka=a(170),Xa=a(94),en=a.n(Xa),tn=a(59),an=a.n(tn),nn=r.a.Fragment,rn=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"createObjItem",value:function(e){return r.a.createElement("span",{key:"objItem--".concat(e[0],"-").concat(e[1]),className:"group-section"},this.deconstructObj(e[1]))}},{key:"createBoolItem",value:function(e){return r.a.createElement("span",{key:"boolItem--".concat(e[0],"-").concat(e[1])},!!e[1]&&e[0])}},{key:"createTimeItem",value:function(e){return r.a.createElement(nn,{key:"dateTime-".concat(e[0]).concat(e[1])},r.a.createElement("span",{className:"detail"},e[0],":"),r.a.createElement("span",{className:"data"},Qt()(e[1]).format("DD/MM/YY,HH:mm")))}},{key:"createStrItem",value:function(e,t){return r.a.createElement(nn,{key:"strItem-".concat(e[0]).concat(e[1])},r.a.createElement("span",{className:"detail"},e[0],":"),r.a.createElement("span",{className:"data"},e[1]))}},{key:"deconstructArr",value:function(e){var t=this;return r.a.createElement(nn,{key:"".concat(e[0],"-group")},r.a.createElement("span",{className:"detail"},e[0]),e[1].map(function(e){return r.a.createElement("span",{key:"section-".concat(e.name)},t.deconstructObj(e))}))}},{key:"deconstructObj",value:function(e){var t=this;return Object.entries(e).map(function(e,a){return Be.a.object(e[1])?t.createObjItem(e):Be.a.array.of.object(e[1])?t.deconstructArr(e):Be.a.boolean(e[1])?t.createBoolItem(e):Qt()(e[1],Qt.a.ISO_8601,!0).isValid()?t.createTimeItem(e):t.createStrItem(e)})}},{key:"render",value:function(){var e=this;if(!this.props.detail)return!1;var t=this;return Object.entries(this.props.detail).map(function(a,n){return 0===n?r.a.createElement(nn,{key:"from-force"},!!e.props.from&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"detail"},"From:"),r.a.createElement("span",{className:"data"},e.props.from))):Be.a.object(a[1])?t.createObjItem(a):Be.a.array.of.object(a[1])?t.deconstructArr(a):Be.a.boolean(a[1])?t.createBoolItem(a):Qt()(a[1],Qt.a.ISO_8601,!0).isValid()?t.createTimeItem(a):r.a.createElement(nn,{key:"".concat(a[0],"-").concat(a[1])},r.a.createElement("span",{className:"detail"},a[0],": "),r.a.createElement("span",{className:"data"},a[1]))})}}]),t}(n.Component),sn=Object(m.b)()(rn),cn=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).openSection=function(e){e.open=!0;var t=a.state.messages.findIndex(function(t){return t.message._id===e.message._id}),n=a.state.messages;n.splice(t,1,e),a.setState({messages:n})},a.closeSection=function(e){e.open=!1;var t=a.state.messages.findIndex(function(t){return t.message._id===e.message._id}),n=a.state.messages;n.splice(t,1,e),a.setState({messages:n})},a.state={messages:[]},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){if(0!==this.props.messages.length&&e.messages.length!==this.props.messages.length){var a={message:e.messages[0],open:!1},n=this.state.messages;n.unshift(a),this.setState({messages:n})}0!==this.props.messages.length&&this.props.curChannel===e.curChannel||this.setState({messages:e.messages.map(function(e){return{message:e,open:!1}}).filter(function(t){return t.message.details.channel===e.curChannel})})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"message-list"},this.state.messages.map(function(t,a){return r.a.createElement(an.a,{key:"".concat(a,"-title"),trigger:r.a.createElement("div",{className:"wrap"},t.message.message.title," ",r.a.createElement(en.a,{pill:!0,variant:"secondary"},t.message.details.messageType)),transitionTime:200,easing:"ease-in-out",open:t.open,onOpening:e.openSection.bind(e,t),onClosing:e.closeSection.bind(e,t)},r.a.createElement("div",{key:a,className:"message-preview-player wrap"},r.a.createElement(sn,{detail:t.message.message,from:t.message.details.from.force})))}))}}]),t}(n.Component),on=Object(m.b)(function(){return{}})(cn),ln=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).sendMessage=function(){var e={channel:a.props.playerUi.selectedChannel,from:{force:a.props.playerUi.selectedForce,role:a.props.selectedRole},messageType:a.props.playerUi.messageSchema.title};a.props.dispatch(z(a.props.playerUi.currentWargame,e,a.editor.getValue())),a.props.dispatch(Z(a.props.playerUi.currentWargame))},a.editor=null,a.editorPreviewRef=r.a.createRef(),a.state={selectedSchema:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){if(this.editor&&(this.editor.destroy(),this.editor=null),e.schema&&e.schema.type){if(this.editor)return;this.editor=new Ht.a(this.editorPreviewRef.current,{schema:e.schema,theme:"bootstrap4",disable_collapse:!0,disable_edit_json:!0,disable_properties:!0})}}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"message-creator",ref:this.editorPreviewRef}),r.a.createElement("button",{name:"send",className:"btn btn-action btn-action--primary",onClick:this.sendMessage},"Send"))}}]),t}(n.Component),un=Object(m.b)(function(e){return{playerUi:e.playerUi}})(ln),pn=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).setTemplate=function(e){a.props.dispatch(J(e)),a.setState({dropdownValue:e})},a.state={dropdownValue:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){this.props.curChannel!==e.curChannel&&this.setState({dropdownValue:""})}},{key:"render",value:function(){var e=this.props.templates.map(function(e){return{value:e.value,option:e.label}});return r.a.createElement("div",{className:"new-message-creator wrap"},r.a.createElement(an.a,{trigger:"New Message",transitionTime:200,easing:"ease-in-out"},r.a.createElement(ka,{updateStore:this.setTemplate,data:this.state.dropdownValue,selectOptions:e,placeholder:"Select message",className:"message-input"}),r.a.createElement(un,{schema:this.props.schema})))}}]),t}(n.Component),mn=Object(m.b)(function(){return{}})(pn);function dn(e){return r.a.createElement(ja.a,{component:"div",style:{display:"flex",flexDirection:"column",height:"calc(100% - 48px)"}},e.children)}var hn=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e,t){var n=Object.keys(a.props.playerUi.channels)[t];a.props.dispatch(q(n)),a.props.dispatch($({})),a.setState({value:t})},a.createTabs=function(){var e=a.props.playerUi.channels,t=[];for(var n in e)t.push(r.a.createElement(Ka.a,{key:n,label:n}));return t},a.createMessageList=function(e){var t=a.props.playerUi.selectedChannel;return r.a.createElement(dn,null,r.a.createElement(on,{curChannel:t,messages:a.props.playerUi.messages}),r.a.createElement(mn,{curChannel:t,schema:a.props.playerUi.messageSchema,templates:a.props.playerUi.channels[t].templates}))},a.state={value:0},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(Z(this.props.playerUi.currentWargame))}},{key:"render",value:function(){var e=this.state.value,t=this.props.classes;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.root},r.a.createElement(Ja.a,{position:"static",color:"default"},r.a.createElement(Za.a,{value:e,onChange:this.handleChange,indicatorColor:"primary",textColor:"primary",centered:!0},this.createTabs())),this.createMessageList(e)))}}]),t}(n.Component),fn=Object(m.b)(function(e){return{playerUi:e.playerUi}})(Object(Ta.a)(function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper}}})(hn)),gn=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).updateSelectedWargame=function(e){a.props.dispatch(Q(e))},a.updateSelectedForce=function(e){a.props.dispatch(V(e))},a.updateSelectedRole=function(e){a.props.dispatch(B(e)),a.props.dispatch(H())},a.goBack=function(){a.props.dispatch(V(""))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{className:"flex-content flex-content--fill"},!this.props.playerUi.currentWargame&&r.a.createElement("div",{className:"flex-content--center"},r.a.createElement("h1",null,"Set wargame"),r.a.createElement(ka,{updateStore:this.updateSelectedWargame,selectOptions:this.props.wargame.wargameList.map(function(e){return{option:e.title,value:e.name}})})),!(!this.props.playerUi.currentWargame||this.props.playerUi.selectedForce)&&r.a.createElement("div",{className:"flex-content--center"},r.a.createElement("h1",null,"Set force"),r.a.createElement(ka,{updateStore:this.updateSelectedForce,selectOptions:this.props.playerUi.allForces.map(function(e){return{option:e.forceName,value:e.forceName}})})),!(!this.props.playerUi.selectedForce||this.props.playerUi.selectedRole)&&r.a.createElement("div",{className:"flex-content--center"},r.a.createElement("h1",null,"Set role"),r.a.createElement(kt.a,{icon:Nt.a,size:"2x",style:{cursor:"pointer"},onClick:this.goBack}),r.a.createElement(ka,{updateStore:this.updateSelectedRole,selectOptions:this.props.playerUi.allForces.find(function(t){return t.forceName===e.props.playerUi.selectedForce}).roles.map(function(e){return{option:e,value:e}})})),!(!this.props.playerUi.selectedForce||!this.props.playerUi.selectedRole)&&r.a.createElement("div",{className:"message-feeds"},r.a.createElement(fn,null))))}}]),t}(n.Component),En=Object(m.b)(function(e){return{playerUi:e.playerUi,wargame:e.wargame}})(gn),vn=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).routes=[{path:"/client",action:function(){return r.a.createElement(Wt,null)}},{path:"/client/umpireMenu",action:function(){return r.a.createElement(Vt,null)}},{path:"/client/umpireMenu/:creatorType",action:function(){return r.a.createElement(ta,null)}},{path:"/client/messageCreator",children:[{path:"/create/template",action:function(){return r.a.createElement(_a,null)}},{path:"/edit/template",action:function(){return r.a.createElement(Sa,null)}},{path:"/create/message",action:function(){return r.a.createElement(ca,null)}},{path:"/edit/message",action:function(){return r.a.createElement(sa,null)}}]},{path:"/client/gameSetup",action:function(){return r.a.createElement(za,null)}},{path:"/client/playerUi",action:function(){return r.a.createElement(En,null)}}],a.state={currentView:r.a.createElement(Wt,null)},a.router=new Rt.a(a.routes),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.router.resolve({pathname:e.currentViewURI}).then(function(e){a.setState({currentView:e})})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.currentView)}}]),t}(n.Component),yn=Object(m.b)(function(e){return{currentViewURI:e.currentViewURI}})(vn),bn=a(51);function wn(e){if(null===e||"object"!==typeof e)return e;var t=e.constructor();for(var a in e)t[a]=wn(e[a]);return t}var Sn={loadingDb:!1,isLoading:!1,messages:[]},On={isLoading:!1,messages:[],messagePreviewId:"",messagePreview:{}},_n={selectedSchemaID:"",previewSchema:{}},Tn={isLoading:!1,wargameList:[],currentWargame:"",wargameTitle:"",validation:{validWargameName:!0,validForceName:!0,validChannelName:!0},data:Object(O.a)({},x.data),currentTab:Object.keys(x.data)[0]},jn=[],Nn={selectedForce:"",selectedRole:"",selectedChannel:"",currentWargame:"",wargameTitle:"",channels:{},allChannels:{},forces:{},allForces:{},messageSchema:{},messages:[]},kn={loadingMessageTypes:!0,loadingWargames:!0},Cn=[a(99).a],Mn=Object(bn.d)(Object(bn.c)({messageTypes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sn,t=arguments.length>1?arguments[1]:void 0,a=wn(e);switch(t.type){case d.DB_MESSAGE_TYPES_GET:return a.isLoading=t.isLoading,a;case d.DB_MESSAGE_TYPES_SAVED:return a.messages=t.payload,a;default:return a}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:On,t=arguments.length>1?arguments[1]:void 0,a=wn(e);switch(t.type){case d.DB_MESSAGES_GET:return a.isLoading=t.isLoading,a;case d.DB_MESSAGE_SAVED:return a.messages=t.payload,a;case d.DB_RETURNED_MESSAGE:return a.messagePreviewId=t.payload._id,a.messagePreview=t.payload,a;case d.RESET_MESSAGE_PREVIEW:return a.messagePreviewId="",a.messagePreview={},a;default:return a}},umpireMenu:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_n,t=arguments.length>1?arguments[1]:void 0,a=wn(e);switch(t.type){case d.SET_SELECTED_SCHEMA:return a.selectedSchemaID=t.payload,a;case d.SET_PREVIEW_SCHEMA:return a.previewSchema=t.payload,a;default:return a}},currentViewURI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=arguments.length>1?arguments[1]:void 0,a=e;switch(t.type){case d.SET_CURRENT_VIEW_FROM_URI:return window.history.pushState({},"",t.payload),a=t.payload;default:return a}},currentModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;wn(e);switch(t.type){case d.OPEN_MODAL:case d.CLOSE_MODAL:return t.payload;default:return{}}},notifications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jn,t=arguments.length>1?arguments[1]:void 0,a=wn(e);switch(t.type){case d.ADD_NOTIFICATION:return console.log(t.payload),a.push(t.payload),a;case d.HIDE_NOTIFICATION:var n=a.findIndex(function(e){return e.id===t.id});return a.splice(n,1),a;default:return a}},wargame:function(){var e,t,a,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tn,s=arguments.length>1?arguments[1]:void 0,i=j(r),c=i.currentTab;switch(s.type){case d.ALL_WARGAME_NAMES_SAVED:return i.wargameList=s.payload,i;case d.SET_CURRENT_WARGAME:return i.currentWargame=s.payload.name,i.wargameTitle=s.payload.wargameTitle,i.data=s.payload.data,i;case d.SET_WARGAME_NAME:return a=[],i.wargameList.forEach(function(e){(function(e){var t=new URL(e).pathname,a=t.lastIndexOf("/");return t.substring(a+1)})(e.name)!==i.currentWargame&&a.push(e)}),n=a.every(function(e){return e.title!==s.payload}),i.validation.validWargameName=n,i.wargameTitle=s.payload,i;case d.SET_CURRENT_GAME_SETUP_TAB:i.currentTab=s.payload;break;case d.SET_GAME_SETUP_DATA:i.data[c]=Object(O.a)({},i.data[c],s.payload);break;case d.ADD_NEW_FORCE:var o=A;o.forceName=s.payload,i.data[c].forces.push(o);break;case d.SET_SELECTED_FORCE:i.data[c].selectedForce=s.payload;break;case d.ADD_NEW_CHANNEL:var l=I;l.channelName=s.payload,i.data[c].channels.push(l);break;case d.UPDATE_CHANNEL_NAME:a=[];var u=i.data[c].data.selectedChannel;Object.keys(i.tabs[c].data.channels).forEach(function(e){e!==u&&a.push(e)}),n=a.every(function(e){return e!==s.name}),i.validation.validChannelName=n,n&&""!==s.name&&(i.tabs[c].data.channels[s.name]=i.tabs[c].data.channels[u],i.tabs[c].data.selectedChannel=s.name,delete i.tabs[c].data.channels[u]);break;case d.SET_SELECTED_CHANNEL:i.data[c].selectedChannel=s.payload;break;case d.DELETE_SELECTED_CHANNEL:var p=i.data[c].channels.findIndex(function(e){return e.channelName===s.payload});i.data[c].channels.splice(p,1),i.data[c].selectedChannel="";break;case d.SET_FORCE_OVERVIEW:var m=i.data[c].selectedForce;i.data[c].forces.find(function(e){return e.forceName===m}).overview=s.payload;break;case d.ADD_NEW_RECIPIENT:e=i.data[c].selectedChannel;var h=Object(O.a)({},s.payload,{subscriptionId:T.a.time()});i.data[c].channels.find(function(t){return t.channelName===e}).participants.push(h);break;case d.UPDATE_RECIPIENT:e=i.data[c].selectedChannel,t=i.data[c].channels.find(function(t){return t.channelName===e}).participants.findIndex(function(e){return e.subscriptionId===s.payload.id}),i.data[c].channels.find(function(t){return t.channelName===e}).participants.splice(t,1,Object(O.a)({},s.payload.data,{subscriptionId:s.payload.id}));break;case d.REMOVE_RECIPIENT:e=i.data[c].selectedChannel,t=i.data[c].channels.find(function(t){return t.channelName===e}).participants.findIndex(function(e){return e.subscriptionId===s.payload}),i.data[c].channels.find(function(t){return t.channelName===e}).participants.splice(t,1);break;default:return i}return i},playerUi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nn,t=arguments.length>1?arguments[1]:void 0,a=j(e);switch(t.type){case d.SET_CURRENT_WARGAME_PLAYER:a.currentWargame=t.payload.name,a.wargameTitle=t.payload.wargameTitle,a.allChannels=t.payload.data.channels.channels,a.allForces=t.payload.data.forces.forces;break;case d.SET_FORCE:a.selectedForce=t.payload;break;case d.SET_ROLE:a.selectedRole=t.payload;break;case d.SET_FILTERED_CHANNELS:var n={};a.allChannels.forEach(function(e){var t=e.participants.filter(function(e){return e.force===a.selectedForce&&e.role===a.selectedRole}),r=e.participants.some(function(e){return e.force===a.selectedForce&&e.role===a.selectedRole});t=S.a.uniqWith(t,S.a.isEqual),r&&(n[e.channelName]={templates:S.a.flatMap(t,function(e){return e.templates}),messages:[]}),a.selectedChannel=Object.keys(n)[0],a.channels=n});break;case d.SET_CHANNEL:a.selectedChannel=t.payload;break;case d.SET_MESSAGE_SCHEMA:a.messageSchema=t.payload;break;case d.SET_LATEST_MESSAGES:a.messages=t.payload;break;default:return a}return a},dbLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kn,t=arguments.length>1?arguments[1]:void 0,a=wn(e);switch(t.type){case d.POPULATE_MESSAGE_TYPES_DB:return a.loadingMessageTypes=t.isLoading,a;case d.POPULATE_WARGAMES_DB:return a.loadingWargames=t.isLoading,a;default:return a}}}),bn.a.apply(void 0,Cn)),An=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){document.title="Serge"}},{key:"render",value:function(){return r.a.createElement(m.a,{store:Mn},r.a.createElement(yn,null),r.a.createElement(jt,null),r.a.createElement(xt,null))}}]),t}(n.Component);i.a.render(r.a.createElement(An,null),document.getElementById("root"))},15:function(e,t,a){},85:function(e){e.exports={type:"object",properties:{title:{type:"string",Title:"Title"},Date:{type:"string",format:"datetime-local",options:{flatpickr:{wrap:!0,time_24hr:!0,allowInput:!0}}},Status:{type:"string",enum:["Minor","Major","Critical"]},Description:{type:"string",format:"textarea"}},title:"Machinery Failure"}},86:function(e){e.exports={type:"object",properties:{title:{type:"string",title:"Title"},Location:{type:"object",properties:{Lat:{type:"number"},"Lat Hemi":{type:"string",enum:["N","S"]},Long:{type:"number"},"Long Hemi":{type:"string",enum:["E","W"]}},format:"grid"},"Valid from":{type:"string",format:"datetime-local",options:{flatpickr:{wrap:!0,time_24hr:!0,allowInput:!0}}},"Valid until":{type:"string",format:"datetime-local",options:{flatpickr:{wrap:!0,time_24hr:!0,allowInput:!0}}},Forecast:{type:"string",format:"textarea"}},title:"Weather Forecast"}},88:function(e){e.exports={$ref:"#/definitions/object",title:"object type",definitions:{string:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"string type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"string"},format:{type:"string",enum:["color","date","datetime","datetime-local","email","month","number","range","tel","text","textarea","time","url","week","json","sql","xml","yaml"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["string"]},enum:{format:"table",items:{title:"alternative",type:"string"},type:"array"},description:{type:"string"}}},null:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"null type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"null"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["null"]},description:{type:"string"}}},array:{required:["type"],defaultProperties:["type","items","title"],additionalProperties:!1,title:"array type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"array"},format:{default:"table",type:"string",enum:["array","table","tabs","tabs-top","checkbox","select","categories"]},items:{$ref:"#/definitions/schema"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["array"]},description:{type:"string"}}},schema:{default:{type:"object"},oneOf:[{$ref:"#/definitions/null",title:"null type"},{$ref:"#/definitions/boolean",title:"boolean type"},{$ref:"#/definitions/string",title:"string type"},{$ref:"#/definitions/integer",title:"integer type"},{$ref:"#/definitions/number",title:"number type"},{$ref:"#/definitions/object",title:"object type"},{$ref:"#/definitions/array",title:"array type"}],options:{keep_oneof_values:!1},type:"object"},boolean:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"boolean type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"boolean"},format:{type:"string",enum:["select","checkbox"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["boolean"]},description:{type:"string"}}},object:{required:["type"],defaultProperties:["type","properties","title"],additionalProperties:!1,title:"object type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"object"},format:{type:"string",enum:["grid"]},required:{uniqueItems:!0,format:"table",items:{title:"property",type:"string"},type:"array"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["object"]},description:{type:"string"},properties:{type:"object",patternProperties:{".*":{$ref:"#/definitions/propertySchema"}}}}},number:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"number type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"number"},default:{type:"number"},minimum:{type:"number"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["number"]},enum:{format:"table",items:{title:"alternative",type:"number"},type:"array"},description:{type:"string"}}},integer:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"integer type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"integer"},default:{type:"integer"},minimum:{type:"integer"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["integer"]},enum:{format:"table",items:{title:"alternative",type:"integer"},type:"array"},description:{type:"string"}}},propertySchema:{default:{type:"object"},oneOf:[{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"null type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"null"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["null"]},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"boolean type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"boolean"},format:{type:"string",enum:["select","checkbox"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["boolean"]},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"string type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"string"},format:{type:"string",enum:["color","date","datetime","datetime-local","email","month","number","range","tel","text","textarea","time","url","week","json","sql","xml","yaml"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["string"]},enum:{format:"table",items:{title:"alternative",type:"string"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"integer type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"integer"},default:{type:"integer"},minimum:{type:"integer"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["integer"]},enum:{format:"table",items:{title:"alternative",type:"integer"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"number type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"number"},default:{type:"number"},minimum:{type:"number"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["number"]},enum:{format:"table",items:{title:"alternative",type:"number"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type","properties"],additionalProperties:!1,title:"object type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"object"},format:{type:"string",enum:["grid"]},required:{uniqueItems:!0,format:"table",items:{title:"property",type:"string"},type:"array"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["object"]},description:{type:"string"},properties:{type:"object",patternProperties:{".*":{$ref:"#/definitions/propertySchema"}}}}},{required:["type"],defaultProperties:["type","items"],additionalProperties:!1,title:"array type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"array"},format:{default:"table",type:"string",enum:["array","table","tabs","tabs-top","checkbox","select","categories"]},items:{$ref:"#/definitions/schema"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["array"]},description:{type:"string"}}}],options:{keep_oneof_values:!1},type:"object"}}}}},[[107,1,2]]]);
//# sourceMappingURL=main.de5500de.chunk.js.map