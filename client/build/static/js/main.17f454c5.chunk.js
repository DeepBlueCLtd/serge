(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(e,t,a){e.exports=a(139)},139:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(43),i=a.n(s),c=a(2),o=a(3),l=a(5),u=a(4),p=a(6),m=a(7),d=(a(14),Object.freeze({ASYNC_SUCCESS:"ASYNC_SUCCESS",ASYNC_ERROR:"ASYNC_ERROR",ASYNC_LOADING:"ASYNC_LOADING",NORMAL_ACTION:"NORMAL_ACTION",DB_MESSAGE_STATUS:"DB_MESSAGE_STATUS",DB_MESSAGE_CREATION_LOADING:"DB_MESSAGE_CREATION_LOADING",DB_MESSAGE_GET_LOADING:"DB_MESSAGE_GET_LOADING",DB_SAVE_MESSAGES:"DB_SAVE_MESSAGES",DB_MESSAGE_TYPES_GET:"DB_MESSAGE_TYPES_GET",DB_MESSAGE_TYPES_SAVED:"DB_MESSAGE_TYPES_SAVED",SET_CURRENT_VIEW_FROM_URI:"SET_CURRENT_VIEW_FROM_URI",DB_MESSAGE_SAVED:"DB_MESSAGE_SAVED",DB_MESSAGES_GET:"DB_MESSAGES_GET",DB_RETURNED_MESSAGE:"DB_RETURNED_MESSAGE",RESET_MESSAGE_PREVIEW:"RESET_MESSAGE_PREVIEW",SET_SELECTED_SCHEMA:"SET_SELECTED_SCHEMA",SET_PREVIEW_SCHEMA:"SET_PREVIEW_SCHEMA",OPEN_MODAL:"OPEN_MODAL",CLOSE_MODAL:"CLOSE_MODAL",SET_CURRENT_GAME_SETUP_TAB:"SET_CURRENT_GAME_SETUP_TAB",SET_GAME_SETUP_DATA:"SET_GAME_SETUP_DATA",ALL_WARGAME_NAMES_SAVED:"ALL_WARGAME_NAMES_SAVED",SET_CURRENT_WARGAME:"SET_CURRENT_WARGAME",ADD_NEW_FORCE:"ADD_NEW_FORCE",SET_SELECTED_FORCE:"SET_SELECTED_FORCE",ADD_NEW_CHANNEL:"ADD_NEW_CHANNEL",SET_SELECTED_CHANNEL:"SET_SELECTED_CHANNEL",SET_WARGAME_NAME:"SET_WARGAME_NAME",SET_FORCE_OVERVIEW:"SET_FORCE_OVERVIEW",GAME_TITLE_INVALID:"GAME_TITLE_INVALID",ADD_NEW_RECIPIENT:"ADD_NEW_RECIPIENT",SHOW_NOTIFICATION:"SHOW_NOTIFICATION",HIDE_NOTIFICATION:"HIDE_NOTIFICATION",UPDATE_RECIPIENT:"UPDATE_RECIPIENT",REMOVE_RECIPIENT:"REMOVE_RECIPIENT",SET_CURRENT_WARGAME_PLAYER:"SET_CURRENT_WARGAME_PLAYER",SET_FORCE:"SET_FORCE",SET_ROLE:"SET_ROLE",SET_FILTERED_CHANNELS:"SET_FILTERED_CHANNELS",SET_CHANNEL:"SET_CHANNEL",SET_MESSAGE_SCHEMA:"SET_MESSAGE_SCHEMA",SET_LATEST_MESSAGES:"SET_LATEST_MESSAGES"})),h={open:function(e){return{type:d.OPEN_MODAL,payload:{open:!0,modal:e}}},close:function(){return{type:d.CLOSE_MODAL,payload:{open:!1,modal:""}}}},f=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleBackgroundClick=function(e){e.target===e.currentTarget&&a.props.dispatch(h.close())},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.editable?"modal setsize":"modal";return r.a.createElement("div",{className:"modal-bg",onClick:this.handleBackgroundClick},r.a.createElement("div",{className:e},this.props.children))}}]),t}(n.Component),E=Object(m.b)()(f),g=a(9),b=a.n(g),y=a(16),v=a(50),S=a(24),O=a.n(S),w=a(41),j=a(44),_=a.n(j),T=a(46),k="https://serge-dev.herokuapp.com/",C="https://serge-dev.herokuapp.com/db/",N={overview:"An overview written here..",roles:["General"]},M=[],I={_id:"_local/settings",wargameTitle:"wargame",tabs:{0:{name:"Overview - settings",data:{gameDescription:"",spatialRepresentation:"",planningInterval:null,replayInterval:null,turnStrategy:""}},1:{name:"Forces",data:{forces:{},roles:["General"],selectedForce:""}},2:{name:"Channels",data:{channels:{},selectedChannel:""}}}},A=a(82),x=a(83),R=new T.a(C+"message_types");R.allDocs().then(function(e){0===e.rows.length&&function(){var e={_id:(new Date).toISOString(),lastUpdated:(new Date).toISOString(),title:"machinery failure",details:A,completed:!1};R.put(e),setTimeout(function(){var e={_id:(new Date).toISOString(),lastUpdated:(new Date).toISOString(),title:"weather forecast",details:x,completed:!1};R.put(e).then(function(){console.log("DATA BASE COMPLETE")})},2e3)}()});var D=function(e){return new Promise(function(t,a){Object(y.a)(b.a.mark(function n(){var r,s,i;return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,U();case 2:if(r=n.sent,!r.find(function(t){return t.title.toLowerCase()===e.title.toLowerCase()})){n.next=7;break}return a("Message title already used"),n.abrupt("return");case 7:return s=(new Date).toISOString(),i={_id:s,lastUpdated:s,title:e.title,details:e,completed:!1},n.abrupt("return",R.put(i).then(function(e){t(e)}).catch(function(e){console.log(e),a(!1)}));case 10:case"end":return n.stop()}},n)}))()})},L=function(e){var t=(new Date).toISOString();return new Promise(function(a,n){R.get(e).then(function(e){return e.details.title="".concat(e.details.title," Copy-").concat(_.a.time()),R.put({_id:t,lastUpdated:t,title:e.details.title,details:e.details})}).then(function(){a(!0)}).catch(function(e){console.log(e),n(!1)})})},P=function(e,t){return new Promise(function(a,n){Object(y.a)(b.a.mark(function r(){var s;return b.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,U();case 2:if(s=r.sent,!s.find(function(t){return t.title.toLowerCase()===e.title.toLowerCase()})){r.next=7;break}return n("Message title already used"),r.abrupt("return");case 7:R.get(t).then(function(t){return R.put({_id:t._id,lastUpdated:(new Date).toISOString(),_rev:t._rev,title:e.title,details:e})}).then(function(e){a(e)}).catch(function(e){console.log(e),n(!1)});case 8:case"end":return r.stop()}},r)}))()})},F=function(e){return new Promise(function(t,a){R.get(e).then(function(e){return R.remove(e)}).then(function(e){t(e)}).catch(function(e){console.log(e),a(!1)})})},U=function(){return new Promise(function(e,t){return R.changes({since:1,include_docs:!0,descending:!0}).then(function(t){var a=t.results.map(function(e){return e.doc});a=a.filter(function(e){return!e.hasOwnProperty("_deleted")&&e.hasOwnProperty("details")}),e(a)}).catch(function(e){t(e),console.log(e)})})},W=function(e){return{type:d.SET_FORCE,payload:e}},G=function(e){return{type:d.SET_ROLE,payload:e}},V=function(){return{type:d.SET_FILTERED_CHANNELS}},B=function(e){return{type:d.SET_CHANNEL,payload:e}},H=function(e){return{type:d.SET_MESSAGE_SCHEMA,payload:e}},$=function(e){return{type:d.SET_LATEST_MESSAGES,payload:e}},q=function(e){return function(){var t=Object(y.a)(b.a.mark(function t(a){var n;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ae(e);case 2:n=t.sent,console.log(n),a((r=n,{type:d.SET_CURRENT_WARGAME_PLAYER,payload:r}));case 5:case"end":return t.stop()}var r},t)}));return function(e){return t.apply(this,arguments)}}()},Y=function(e,t,a){return function(){var n=Object(y.a)(b.a.mark(function n(r){var s;return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ne(e,t,a);case 2:return console.log(e),n.next=5,re(e);case 5:s=n.sent,r($(s));case 7:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()},Q=function(e){return function(){var t=Object(y.a)(b.a.mark(function t(a){var n,r;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U();case 2:n=t.sent,r=n.find(function(t){return t._id===e}),a(H(r.details));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},z=function(e){return function(){var t=Object(y.a)(b.a.mark(function t(a){var n;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,re(e);case 2:n=t.sent,a($(n));case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},J=[],Z=function(e){return Object(v.a)(k+"allDbs").then(function(e){return e.json()}).then(function(t){var a=J.map(function(e){return e.name}),n=O.a.difference(t,a);(n=O.a.pull(n,"messages","message_types","_replicator","_users")).forEach(function(t){var a=new T.a(C+t);a.setMaxListeners(11),function e(t,a,n){t.changes({since:"now",live:!0,timeout:!1,heartbeat:!1}).on("change",function(){Object(y.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re(a);case 2:t=e.sent,n($(t));case 4:case"end":return e.stop()}},e)}))()}).on("error",function(r){console.log(r),e(t,a,n)})}(a,t,e),J.unshift({name:t,db:a})});var r=J.map(function(e){return e.db.get(I._id).then(function(t){return{name:e.db.name,title:t.wargameTitle}}).catch(function(e){console.log(e)})});return Promise.all(r)}).catch(function(e){console.log(e)})},K=function(){var e=_.a.time(),t="wargame-".concat(e);return new Promise(function(a,n){var r=new T.a(C+t);J.unshift({name:t,db:r});var s=Object(w.a)({},I,{name:t});s.wargameTitle="".concat(s.wargameTitle,"-").concat(e),r.put(s).then(function(){a(r.get(s._id))})})},X=function(e){var t=ce(e);return new Promise(function(e,a){try{J.find(function(e){return e.name===t}).db.get(I._id).then(function(t){e(t)})}catch(n){a(n)}})},ee=function(e,t,a){return se().then(function(n){return n.some(function(t){return t.title===a&&ce(t.name)!==e})?"invalid":ie(e,t,a)}).catch(function(e){return e})},te=function(e){var t=ce(e),a=J.find(function(e){return e.name===t}).db,n=_.a.time();return new Promise(function(e,t){var r,s="wargame-".concat(n);a.get(I._id).then(function(e){return r=new T.a(C+s),e}).then(function(e){return r.put({_id:I._id,name:s,wargameTitle:"".concat(e.wargameTitle,"-").concat(n),tabs:e.tabs}).then(function(){return e})}).then(function(){return J.unshift({name:s,db:r}),se()}).then(function(t){e(t)}).catch(function(e){t(e),console.log(e)})})},ae=function(e){var t=ce(e),a=J.find(function(e){return t===e.name});return console.log(a),new Promise(function(e,t){a.db.get(I._id).then(function(t){e(t)}).catch(function(e){t(e)})})},ne=function(e,t,a){var n=J.find(function(t){return t.name===e}).db;return new Promise(function(e,r){n.put({_id:(new Date).toISOString(),details:t,message:a}).then(function(t){console.log(t),e(t)}).catch(function(e){console.log(e)})})},re=function(e){var t=J.find(function(t){return t.name===e}).db;return new Promise(function(e,a){t.allDocs({include_docs:!0,descending:!0}).then(function(t){e(t.rows.map(function(e){return e.doc}))}).catch(function(e){a(e)})})},se=function(){var e=J.map(function(e){return e.db.get(I._id).then(function(t){return{name:e.db.name,title:t.wargameTitle}}).catch(function(e){console.log(e)})});return Promise.all(e)},ie=function(e,t,a){console.log(e);var n=J.find(function(t){return t.name===e}).db;return new Promise(function(r,s){n.get(I._id).then(function(i){n.put({_id:I._id,_rev:i._rev,name:e,wargameTitle:a,tabs:t}).then(function(){r(n.get(I._id))}).catch(function(e){s(e)})})})},ce=function(e){var t=new URL(e).pathname,a=t.lastIndexOf("/");return t.substring(a+1)},oe=function(e){return{type:d.SHOW_NOTIFICATION,payload:{open:!0,message:e}}},le=function(){return{type:d.HIDE_NOTIFICATION,payload:{open:!1,message:""}}},ue=function(e){return{type:d.SET_CURRENT_GAME_SETUP_TAB,payload:e}},pe=function(e){return{type:d.SET_GAME_SETUP_DATA,payload:e}},me=function(e){return{type:d.SET_WARGAME_NAME,payload:e}},de=function(e){return{type:d.ADD_NEW_FORCE,payload:e}},he=function(e){return{type:d.SET_SELECTED_FORCE,payload:e}},fe=function(e){return{type:d.ADD_NEW_CHANNEL,payload:e}},Ee=function(e){return{type:d.SET_SELECTED_CHANNEL,payload:e}},ge=function(e){return{type:d.SET_FORCE_OVERVIEW,payload:e}},be=function(e){return{type:d.ALL_WARGAME_NAMES_SAVED,payload:e}},ye=function(e){return{type:d.SET_CURRENT_WARGAME,payload:e}},ve=function(e){return{type:d.ADD_NEW_RECIPIENT,payload:e}},Se=function(e,t){return{type:d.UPDATE_RECIPIENT,payload:{id:e,data:t}}},Oe=function(){return function(){var e=Object(y.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K();case 2:return a=e.sent,e.next=5,se();case 5:n=e.sent,t(be(n)),t(ye(O.a.omit(a,["_id","_rev"])));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},we=function(){return function(){var e=Object(y.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,void Object(v.a)(k+"clearAll").then(function(){window.location.reload(!0)});case 2:return e.next=4,se();case 4:a=e.sent,t(be(a));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},je=function(e,t,a){return function(){var n=Object(y.a)(b.a.mark(function n(r){var s,i;return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ee(e,t,a);case 2:return s=n.sent,n.next=5,se();case 5:i=n.sent,r(be(i)),r(ye(s)),r(oe("wargame saved."));case 9:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()},_e=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).hideModal=function(){a.setState({forceName:""}),a.props.dispatch(h.close())},a.setNewForceName=function(e){a.setState({forceName:e.target.value,sameName:a.props.wargame.tabs[a.props.wargame.currentTab].data.forces[e.target.value]})},a.addForce=function(){a.props.dispatch(de(a.state.forceName)),a.props.dispatch(he(a.state.forceName))},a.state={forceName:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){if(!this.props.currentModal.open)return!1;var e=this.state.forceName.length<1||this.state.sameName;return r.a.createElement(E,null,r.a.createElement("div",{className:"display-text-wrapper"},r.a.createElement("h3",null,"Create force"),!!this.state.sameName&&r.a.createElement("p",{className:"notification"},"Already exists"),r.a.createElement("input",{autoFocus:!0,className:"modal-input",type:"text",onChange:this.setNewForceName}),r.a.createElement("div",{className:"buttons"},r.a.createElement("button",{disabled:e,name:"add",className:"btn btn-action btn-action--primary",onClick:this.addForce},"Add"),r.a.createElement("button",{name:"cancel",className:"btn btn-action btn-action--secondary",onClick:this.hideModal},"Cancel"))))}}]),t}(n.Component),Te=Object(m.b)(function(e){return{wargame:e.wargame,currentModal:e.currentModal}})(_e),ke=a(96),Ce=a(19),Ne=a.n(Ce),Me=new T.a(C+"messages"),Ie=function(e,t){return new Promise(function(a,n){Object(y.a)(b.a.mark(function r(){var s,i,c;return b.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,xe();case 2:if(s=r.sent,!s.find(function(t){return t.details.title===e.title&&t._id!==e.id})){r.next=7;break}return n("Message title already used"),r.abrupt("return");case 7:return i=(new Date).toISOString(),c={_id:i,lastUpdated:i,details:e,schema:t,completed:!1},r.abrupt("return",Me.put(c).then(function(e){a(e)}).catch(function(e){console.log(e),n(!1)}));case 10:case"end":return r.stop()}},r)}))()})},Ae=function(e){var t=(new Date).toISOString();return new Promise(function(a,n){Me.get(e).then(function(e){var a=e.details;return a.title="".concat(a.title," Copy-").concat(_.a.time()),Me.put({_id:t,lastUpdated:t,details:a,schema:e.schema})}).then(function(){a(!0)}).catch(function(e){console.log(e),n(!1)})})},xe=function(){return new Promise(function(e,t){return Me.changes({since:0,include_docs:!0,descending:!0}).then(function(t){var a=t.results.map(function(e){return e.doc});a=a.filter(function(e){return!e.hasOwnProperty("_deleted")&&e.hasOwnProperty("details")}),e(a)}).catch(function(e){t(e),console.log(e)})})},Re=function(e,t){return new Promise(function(a,n){Object(y.a)(b.a.mark(function r(){var s;return b.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,xe();case 2:if(s=r.sent,!s.find(function(a){return a.details.title===t.title&&a._id!==e})){r.next=7;break}return n("Message title already used"),r.abrupt("return");case 7:Me.get(e).then(function(a){return Me.put({_id:e,lastUpdated:(new Date).toISOString(),_rev:a._rev,details:t,schema:a.schema})}).then(function(e){a(e)}).catch(function(e){console.log(e),n(!1)});case 8:case"end":return r.stop()}},r)}))()})},De=function(e){return new Promise(function(t,a){Me.get(e,{include_docs:!0},function(e,n){e&&a("something went wrong"),t(n)})})},Le=function(e){return new Promise(function(t,a){Me.get(e).then(function(e){return Me.remove(e)}).then(function(e){t(e)}).catch(function(e){console.log(e),a(!1)})})},Pe=function(e){return{type:d.SET_CURRENT_VIEW_FROM_URI,payload:e}},Fe=function(e){return{type:d.DB_MESSAGE_STATUS,payload:e}},Ue=function(e){return{type:d.DB_MESSAGE_SAVED,payload:e}},We=function(e){return{type:d.DB_RETURNED_MESSAGE,payload:e}},Ge=function(e){return{type:d.DB_MESSAGE_CREATION_LOADING,isLoading:e}},Ve=function(e){return{type:d.DB_MESSAGES_GET,isLoading:e}},Be=function(){return{type:d.RESET_MESSAGE_PREVIEW}},He=function(e,t){if(!Ne.a.object(e))throw Error("createMessageType() requires object with message, from & to NOT. ".concat(e));return function(){var a=Object(y.a)(b.a.mark(function a(n){var r,s;return b.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n(Ge(!0)),a.prev=1,a.next=4,Ie(e,t);case 4:if((r=a.sent).err&&n(oe(r.err)),!r.ok){a.next=14;break}return n(Fe(r)),a.next=10,xe();case 10:s=a.sent,n(Ue(s)),n(Ge(!1)),n(Pe("/client/umpireMenu/library"));case 14:a.next=20;break;case 16:a.prev=16,a.t0=a.catch(1),n(Ge(!1)),alert(a.t0);case 20:case"end":return a.stop()}},a,null,[[1,16]])}));return function(e){return a.apply(this,arguments)}}()},$e=function(e){if(!Ne.a.string(e))throw Error("duplicateMessage() requires a string Not. ".concat(e));return function(){var t=Object(y.a)(b.a.mark(function t(a){var n,r;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(Ge(!0)),t.next=3,Ae(e);case 3:if(!(n=t.sent)){t.next=10;break}return a(Fe(n)),t.next=8,xe();case 8:r=t.sent,a(Ue(r));case 10:a(Ge(!1));case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},qe=function(e,t){if(!Ne.a.object(e))throw Error("updateMessage() requires object with message, from & to NOT. ".concat(e));return function(){var a=Object(y.a)(b.a.mark(function a(n){var r,s,i,c,o;return b.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n(Ge(!0)),a.prev=1,a.next=4,Re(t,e);case 4:if((r=a.sent).err&&n(oe(r.err)),!r.ok){a.next=16;break}return n(Fe(r)),a.next=10,Promise.all([xe(),De(r.id)]);case 10:s=a.sent,i=Object(ke.a)(s),c=i[0],o=i[1],n(We(o)),n(Ue(c)),n(Ge(!1)),n(Pe("/client/umpireMenu/library"));case 16:a.next=22;break;case 18:a.prev=18,a.t0=a.catch(1),n(Ge(!1)),alert(a.t0);case 22:case"end":return a.stop()}},a,null,[[1,18]])}));return function(e){return a.apply(this,arguments)}}()},Ye=function(e){if(!Ne.a.string(e))throw Error("duplicateMessage() requires a string Not. ".concat(e));return function(){var t=Object(y.a)(b.a.mark(function t(a){var n;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(Ge(!0)),t.next=3,Le(e);case 3:if(!t.sent){t.next=12;break}return t.next=7,xe();case 7:n=t.sent,a(Ue(n)),a(Be()),t.next=12;break;case 12:a(Ge(!1));case 13:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},Qe=function(e){if(!Ne.a.string(e))throw Error("duplicateMessage() requires a string id..");return function(){var t=Object(y.a)(b.a.mark(function t(a){var n;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(Ve(!0)),t.next=3,De(e);case 3:n=t.sent,a(We(n)),a(Ve(!1));case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},ze=function(e){return{type:d.DB_MESSAGE_STATUS,payload:e}},Je=function(e){return{type:d.DB_MESSAGE_TYPES_SAVED,payload:e}},Ze=function(e){return{type:d.DB_MESSAGE_CREATION_LOADING,isLoading:e}},Ke=function(e){return{type:d.DB_MESSAGE_TYPES_GET,isLoading:e}},Xe=function(e){if(!Ne.a.object(e))throw Error("createMessageType() requires schema object & NOT. ".concat(e));return function(){var t=Object(y.a)(b.a.mark(function t(a){var n,r;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(Ze(!0)),t.prev=1,t.next=4,D(e);case 4:if((n=t.sent).err&&(a(oe(n.err)),a(Ze(!1))),!n.ok){t.next=14;break}return a(ze(n)),t.next=10,U();case 10:r=t.sent,a(Je(r)),a(Ze(!1)),a(Pe("/client/umpireMenu/templates"));case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(1),console.log(t.t0);case 19:case"end":return t.stop()}},t,null,[[1,16]])}));return function(e){return t.apply(this,arguments)}}()},et=function(e){if(!Ne.a.string(e))throw Error("duplicateTemplate() requires a string Not. ".concat(e));return function(){var t=Object(y.a)(b.a.mark(function t(a){var n;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(Ze(!0)),t.next=3,L(e);case 3:if(!t.sent){t.next=10;break}return a(ze(!0)),t.next=8,U();case 8:n=t.sent,a(Je(n));case 10:a(Ze(!1));case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},tt=function(e,t){if(!Ne.a.object(e))throw Error("updateMessageType() requires schema & not ".concat(e));return function(){var a=Object(y.a)(b.a.mark(function a(n){var r,s;return b.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n(Ze(!0)),a.prev=1,a.next=4,P(e,t);case 4:if((r=a.sent).err&&(n(oe(r.err)),n(Ze(!1))),!r.ok){a.next=14;break}return n(ze(r.ok)),a.next=10,U();case 10:s=a.sent,n(Je(s)),n(Ze(!1)),n(Pe("/client/umpireMenu/templates"));case 14:a.next=20;break;case 16:a.prev=16,a.t0=a.catch(1),n(Ze(!1)),alert(a.t0);case 20:case"end":return a.stop()}},a,null,[[1,16]])}));return function(e){return a.apply(this,arguments)}}()},at=function(e){if(!Ne.a.string(e))throw Error("deleteMessage() requires a string of id not. ".concat(e));return function(){var t=Object(y.a)(b.a.mark(function t(a){var n;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(Ze(!0)),t.next=3,F(e);case 3:if(!t.sent){t.next=11;break}return t.next=7,U();case 7:n=t.sent,a(Je(n)),t.next=11;break;case 11:a(Ze(!1));case 12:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},nt=function(){return function(){var e=Object(y.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(Ke(!0)),e.next=3,U();case 3:a=e.sent,t(Je(a)),t(Ke(!1));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},rt=function(e){return{type:d.SET_SELECTED_SCHEMA,payload:e}},st=function(e){return{type:d.SET_PREVIEW_SCHEMA,payload:e}},it=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).hideModal=function(){a.props.dispatch(h.close())},a.deleteMessage=function(){"/client/umpireMenu/templates"===a.props.currentViewURI?(a.props.dispatch(at(a.props.umpireMenu.selectedSchemaID)),a.props.dispatch(st("")),a.props.dispatch(rt(""))):a.props.dispatch(Ye(a.props.messages.messagePreviewId))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return!!this.props.currentModal.open&&r.a.createElement(E,null,r.a.createElement("div",{className:"display-text-wrapper"},r.a.createElement("h3",null,"Delete"),r.a.createElement("p",null,"This will permanently remove the message.",r.a.createElement("br",null),"Are you sure?"),r.a.createElement("div",{className:"buttons"},r.a.createElement("button",{name:"delete",className:"btn btn-action btn-action--primary",onClick:this.deleteMessage},"Delete"),r.a.createElement("button",{name:"cancel",className:"btn btn-action btn-action--secondary",onClick:this.hideModal},"Cancel"))))}}]),t}(n.Component),ct=Object(m.b)(function(e){return{currentModal:e.currentModal,messages:e.messages,umpireMenu:e.umpireMenu,currentViewURI:e.currentViewURI}})(it),ot=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).hideModal=function(){a.setState({channelName:""}),a.props.dispatch(h.close())},a.setChannelName=function(e){a.setState({channelName:e.target.value,sameName:a.props.wargame.tabs[a.props.wargame.currentTab].data.channels[e.target.value]})},a.addChannel=function(){a.props.dispatch(fe(a.state.channelName)),a.props.dispatch(Ee(a.state.channelName))},a.state={channelName:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){if(!this.props.currentModal.open)return!1;var e=this.state.channelName.length<1||this.state.sameName;return r.a.createElement(E,null,r.a.createElement("div",{className:"display-text-wrapper"},r.a.createElement("h3",null,"Create channel"),!!this.state.sameName&&r.a.createElement("p",{className:"notification"},"Already exists"),r.a.createElement("input",{autoFocus:!0,className:"modal-input",type:"text",onChange:this.setChannelName}),r.a.createElement("div",{className:"buttons"},r.a.createElement("button",{disabled:e,name:"add",className:"btn btn-action btn-action--primary",onClick:this.addChannel},"Add"),r.a.createElement("button",{name:"cancel",className:"btn btn-action btn-action--secondary",onClick:this.hideModal},"Cancel"))))}}]),t}(n.Component),lt=Object(m.b)(function(e){return{wargame:e.wargame,currentModal:e.currentModal}})(ot),ut=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e;switch(this.props.currentModal.modal){case"addForce":e=r.a.createElement(Te,null);break;case"delete":e=r.a.createElement(ct,null);break;case"addChannel":e=r.a.createElement(lt,null);break;default:e=!1}return r.a.createElement(r.a.Fragment,null,e)}}]),t}(n.Component),pt=Object(m.b)(function(e){return{currentModal:e.currentModal}})(ut),mt=a(11),dt=a(12),ht=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onClickHandler=function(e){a.props.dispatch(le())},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return!!this.props.notification.open&&r.a.createElement("div",{id:"notification"},this.props.notification.message,r.a.createElement(dt.a,{icon:mt.f,onClick:this.onClickHandler}))}}]),t}(n.Component),ft=Object(m.b)(function(e){return{notification:e.notification}})(ht),Et=a(84),gt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onClickHandler=function(e){a.props.onClickHandler&&a.props.onClickHandler();var t=e.metaKey||e.ctrlKey,n=a.props.href.startsWith("http");t||n||(e.preventDefault(),a.props.dispatch(Pe(a.props.href)))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("span",{href:this.props.href,onClick:this.props.disabled?function(){return!1}:this.onClickHandler,id:this.props.id?this.props.id:null,className:this.props.class?this.props.class:null},this.props.children)}}]),t}(n.Component),bt=Object(m.b)()(gt),yt=a(23),vt=a.n(yt),St=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(function(){var e=Object(y.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(t);case 2:a=e.sent,t(be(a));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}},{key:"render",value:function(){var e=this.props.wargame.wargameList.length>0;return r.a.createElement("div",{id:"umpire",className:"flex-content-wrapper"},r.a.createElement("div",{className:"flex-content flex-content--fill"},r.a.createElement(bt,{href:"/client/umpireMenu",class:"link link--secondary link--large"},"Umpire Menu"),r.a.createElement(bt,{href:"/client/playerUi",disabled:!e,class:vt()("link","link--secondary","link--large",{"link--disabled":!e})},"Player UI"),!e&&r.a.createElement("p",null,"At least one wargame needed to access player ui")))}}]),t}(n.Component),Ot=Object(m.b)(function(e){return{wargame:e.wargame}})(St),wt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).filterMessages=function(e){var t=e?e.target.value:a.state.searchInput,n=a.props.listData.filter(function(e){return e.title.toLowerCase().indexOf(t.toLowerCase())>-1});a.setState({searchQuery:n,searchInput:e?t:a.state.searchInput})},a.displayControls=function(e){a.setState({activeTitle:e})},a.hideControls=function(){a.setState({activeTitle:!1})},a.state={messageList:a.props.listData,searchQuery:a.props.listData,searchInput:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillUpdate",value:function(e,t,a){var n=O.a.difference(e.listData,this.state.messageList).length;(e.listData.length!==this.state.messageList.length||0!==n&&0===this.state.searchInput.length)&&this.setState({messageList:e.listData}),this.state.searchInput.length>0&&0!==n&&this.filterMessages()}},{key:"setSelectedWargame",value:function(e){this.props.dispatch(function(e){return function(){var t=Object(y.a)(b.a.mark(function t(a){var n;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X(e);case 2:n=t.sent,console.log(n),a(ye(n));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}(e)),this.props.dispatch(Pe("/client/gameSetup"))}},{key:"duplicateWargame",value:function(e){var t;this.props.dispatch((t=e,function(){var e=Object(y.a)(b.a.mark(function e(a){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te(t);case 2:n=e.sent,a(be(n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()))}},{key:"render",value:function(){var e=this,t=this.state.searchInput?this.state.searchQuery:this.state.messageList;return r.a.createElement("div",{className:"searchlist"},r.a.createElement("input",{type:"text",className:"searchlist-input",key:"search-templates",placeholder:"Search games",onChange:this.filterMessages,value:this.state.searchInput}),r.a.createElement("div",{className:"searchlist-list"},t.map(function(t){return r.a.createElement("span",{className:"searchlist-title",key:t.title,onMouseOver:e.displayControls.bind(e,t.title),onMouseLeave:e.hideControls},t.title,e.state.activeTitle===t.title?r.a.createElement(r.a.Fragment,null,r.a.createElement(dt.a,{icon:mt.c,onClick:e.setSelectedWargame.bind(e,t.name)}),r.a.createElement(dt.a,{icon:mt.b,onClick:e.duplicateWargame.bind(e,t.name)})):null)})))}}]),t}(n.Component),jt=Object(m.b)(function(){return{}})(wt),_t=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).createWargame=function(){a.props.dispatch(Oe())},a.clearWargames=function(){a.props.dispatch(we())},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"umpire",className:"flex-content-wrapper"},r.a.createElement("div",{className:"flex-content flex-content--big"},r.a.createElement(bt,{href:"/client/umpireMenu/templates",class:"link link--secondary link--large"},"Message Templates"),r.a.createElement(bt,{href:"/client/umpireMenu/library",class:"link link--secondary link--large"},"Message Library")),r.a.createElement("div",{className:"flex-content flex-content--big"},r.a.createElement("span",null,"Games"),r.a.createElement(bt,{href:"/client/gameSetup",class:"link link--noIcon",onClickHandler:this.createWargame},"Create"),r.a.createElement(bt,{href:"/client/umpireMenu",class:"link link--noIcon link--secondary",onClickHandler:this.clearWargames},"Clear wargames"),r.a.createElement(jt,{key:"searchlist",listData:this.props.wargame.wargameList})))}}]),t}(n.Component),Tt=Object(m.b)(function(e){return{wargame:e.wargame}})(_t),kt=a(21),Ct=a.n(kt),Nt=(a(120),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).saveMessage=function(){var e=a.props.messageTypes.messages.find(function(e){return e._id===a.props.umpireMenu.selectedSchemaID}).details;a.props.dispatch(He(a.editor.getValue(),Object(w.a)({},e,{_id:a.props.umpireMenu.selectedSchemaID})))},a.editor=null,a.editorPreviewRef=r.a.createRef(),a.state={selectedSchema:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillUpdate",value:function(e,t,a){if(this.editor&&e.umpireMenu.selectedSchemaID!==this.props.umpireMenu.selectedSchemaID&&(this.editor.destroy(),this.editor=null),e.umpireMenu.selectedSchemaID.length>0&&e.messageTypes&&e.messageTypes.messages.length>0){if(this.editor)return;this.editor=new Ct.a(this.editorPreviewRef.current,{schema:e.messageTypes.messages.find(function(t){return t._id===e.umpireMenu.selectedSchemaID}).details,theme:"bootstrap4"})}if(e.messages.messagePreviewId.length>0&&e.messageTypes.messages.length>0&&!e.disabled){var n=e.messages.messages.find(function(t){return t._id.toLowerCase().indexOf(e.messages.messagePreviewId.toLowerCase())>-1});this.editor.setValue(n.details)}this.props.disabled&&this.editor&&this.editor.disable()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"button-wrap"},this.props.disabled?null:r.a.createElement("span",{onClick:this.saveMessage,className:"link"},r.a.createElement(dt.a,{icon:mt.e}),"Save Message")),r.a.createElement("div",{id:"preview-editor",ref:this.editorPreviewRef}),r.a.createElement("div",{className:"button-wrap"},this.props.disabled?null:r.a.createElement("span",{onClick:this.saveMessage,className:"link"},r.a.createElement(dt.a,{icon:mt.e}),"Save Message")))}}]),t}(n.Component)),Mt=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes,selectedSchema:e.selectedSchema,umpireMenu:e.umpireMenu}})(Nt),It=a(30),At=a.n(It),xt=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"createObjItem",value:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{key:"objItem--".concat(e[0],"-").concat(e[1]),className:"group-section"},this.deconstructObj(e[1])))}},{key:"createBoolItem",value:function(e){return r.a.createElement("span",{key:"boolItem--".concat(e[0],"-").concat(e[1])},!!e[1]&&e[0])}},{key:"createTimeItem",value:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,e[0]),r.a.createElement("span",{key:"dateTime-".concat(e[1])},At()(e[1]).format("Do MMMM YYYY, HH:mm")))}},{key:"createStrItem",value:function(e,t){return r.a.createElement("span",{key:"strItem-".concat(e[0],"-").concat(e[1])},r.a.createElement("b",null,e[0],": "),e[1])}},{key:"deconstructArr",value:function(e){var t=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,e[0]),e[1].map(function(e){return r.a.createElement("span",{key:"section-".concat(e.name)},t.deconstructObj(e))}))}},{key:"deconstructObj",value:function(e){var t=this;return Object.entries(e).map(function(e,a){return Ne.a.object(e[1])?t.createObjItem(e):Ne.a.array.of.object(e[1])?t.deconstructArr(e):Ne.a.boolean(e[1])?t.createBoolItem(e):At()(e[1],At.a.ISO_8601,!0).isValid()?t.createTimeItem(e):t.createStrItem(e)})}},{key:"render",value:function(){var e=this;if(!this.props.detail)return!1;var t=this;return Object.entries(this.props.detail).map(function(a,n){return 0===n?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{key:"title-".concat(a[1])},a[1]),!!e.props.from&&r.a.createElement("span",{key:"from"},"From: ",e.props.from)):Ne.a.object(a[1])?t.createObjItem(a):Ne.a.array.of.object(a[1])?t.deconstructArr(a):Ne.a.boolean(a[1])?t.createBoolItem(a):At()(a[1],At.a.ISO_8601,!0).isValid()?t.createTimeItem(a):r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,a[0]),r.a.createElement("span",{key:"".concat(a[0],"-").concat(a[1])},a[1]))})}}]),t}(n.Component),Rt=Object(m.b)()(xt),Dt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).setSelected=function(e){a.props.setSelected(e)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"searchlist"},r.a.createElement("input",{type:"text",className:"searchlist-input",key:"search-templates",placeholder:this.props.placeholder,onChange:this.props.filter,value:this.props.searchQuery}),r.a.createElement("div",{className:"searchlist-list"},this.props.listData.map(function(t){var a=t._id===e.props.selected?"active":null,n=t.details.title,s=At()(t.lastUpdated).format("DD/MM/YY");return r.a.createElement("span",{className:vt()({"searchlist-title":!0,active:a}),href:"#",onClick:e.setSelected.bind(e,t),key:t._id},n," - ",s)})))}}]),t}(n.Component),Lt=Object(m.b)(function(e){return{currentViewURI:e.currentViewURI,umpireMenu:e.umpireMenu}})(Dt),Pt=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).setSelectedSchemaId=function(e){switch(a.state.creatorType){case"templates":a.props.dispatch(rt(e._id));break;case"library":a.props.dispatch(rt(e.schema._id)),a.props.dispatch(Qe(e._id));break;default:console.log("error")}},a.filterMessages=function(e){var t,n=e?e.target.value:a.state.searchQuery;switch(a.state.creatorType){case"templates":t=a.props.messageTypes.messages.filter(function(e){return e.details.title.toLowerCase().indexOf(n.toLowerCase())>-1});break;case"library":t=a.props.messages.messages.filter(function(e){return e.details.title.toLowerCase().indexOf(n.toLowerCase())>-1});break;default:t=[]}a.setState({messageList:t,searchQuery:n})},a.duplicateTemplate=function(){a.props.dispatch(et(a.props.umpireMenu.selectedSchemaID))},a.deleteTemplate=function(){a.props.dispatch(h.open("delete"))},a.duplicateMessage=function(){a.props.dispatch($e(a.props.messages.messagePreviewId))},a.deleteMessage=function(){a.props.dispatch(h.open("delete"))};var n=a.props.currentViewURI.split("/")[3];return a.state={searchQuery:"",creatorType:n,messageList:"templates"===n?a.props.messageTypes.messages:a.props.messages.messages},a.buildMessageBoard(),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(rt(""))}},{key:"componentWillReceiveProps",value:function(e,t){0===this.state.searchQuery.length&&this.setState({messageList:"templates"===this.state.creatorType?e.messageTypes.messages:e.messages.messages}),e.messages.messages.length!==this.props.messages.messages.length&&setTimeout(this.filterMessages,1)}},{key:"buildMessageBoard",value:function(){switch(this.state.creatorType){case"templates":this.props.dispatch(nt());break;case"library":this.props.dispatch(function(){var e=Object(y.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(Ve(!0)),e.next=3,xe();case 3:a=e.sent,t(Ue(a)),t(Ve(!1));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}}},{key:"createSearchListSection",value:function(){switch(this.state.creatorType){case"templates":return[r.a.createElement(bt,{href:"/client/messageCreator/create/template",key:"templates",class:"link"},r.a.createElement(dt.a,{icon:mt.d}),"Create new template"),r.a.createElement(Lt,{key:"searchlist",listData:this.state.messageList,searchQuery:this.state.searchQuery,filter:this.filterMessages,selected:this.props.umpireMenu.selectedSchemaID,setSelected:this.setSelectedSchemaId,placeholder:"Select template"})];case"library":return[r.a.createElement(bt,{href:"/client/messageCreator/create/message",key:"messages",class:"link"},r.a.createElement(dt.a,{icon:mt.d}),"Create new Message"),r.a.createElement(Lt,{key:"searchlist",listData:this.state.messageList,searchQuery:this.state.searchQuery,filter:this.filterMessages,selected:this.props.messages.messagePreviewId,setSelected:this.setSelectedSchemaId,placeholder:"Select template"})]}}},{key:"createMessagesActions",value:function(){return this.props.messages.messagePreviewId.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(bt,{class:"link link--secondary",href:"templates"===this.state.creatorType?"/messageCreator/edit/template":"/messageCreator/edit/message"},r.a.createElement(dt.a,{icon:mt.c}),"Edit"),r.a.createElement("span",{className:"link link--secondary",onClick:this.duplicateMessage},r.a.createElement(dt.a,{icon:mt.b}),"Duplicate"),r.a.createElement("span",{className:"link link--secondary",onClick:this.deleteMessage},r.a.createElement(dt.a,{icon:mt.g}),"Delete")):null}},{key:"createTemplatesActions",value:function(){return this.props.umpireMenu.selectedSchemaID.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(bt,{class:"link link--secondary",href:"templates"===this.state.creatorType?"/messageCreator/edit/template":"/messageCreator/edit/message"},r.a.createElement(dt.a,{icon:mt.c}),"Edit"),r.a.createElement("span",{className:"link link--secondary",onClick:this.duplicateTemplate},r.a.createElement(dt.a,{icon:mt.b}),"Duplicate"),r.a.createElement("span",{className:"link link--secondary",onClick:this.deleteTemplate},r.a.createElement(dt.a,{icon:mt.g}),"Delete")):null}},{key:"render",value:function(){return r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(bt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(dt.a,{icon:mt.a,size:"2x"}))),r.a.createElement("h1",null,"Message ",this.state.creatorType),r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{id:"selection",className:"flex-content"},this.createSearchListSection()),r.a.createElement("div",{id:"preview",className:"flex-content flex-content--big"},r.a.createElement("p",{className:"heading--sml"},"Preview"),"templates"===this.state.creatorType?r.a.createElement(Mt,{id:"preview",disabled:!0,previewForm:!0}):r.a.createElement("div",{className:"message-preview"},r.a.createElement(Rt,{detail:this.props.messages.messagePreview.details}))),r.a.createElement("div",{id:"function",className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml"},"Actions"),"templates"===this.state.creatorType?this.createTemplatesActions():this.createMessagesActions())))}}]),t}(n.Component),Ft=Object(m.b)(function(e){return{messageTypes:e.messageTypes,messages:e.messages,currentViewURI:e.currentViewURI,umpireMenu:e.umpireMenu}})(Pt),Ut=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).saveMessage=function(){a.props.dispatch(qe(a.editor.getValue(),a.props.messages.messagePreviewId))},a.editor=null,a.editorPreviewRef=r.a.createRef(),a.state={selectedSchema:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillUpdate",value:function(e,t,a){if(this.editor&&e.umpireMenu.selectedSchemaID!==this.props.umpireMenu.selectedSchemaID&&(this.editor.destroy(),this.editor=null),e.messages.messagePreviewId.length>0||e.umpireMenu.selectedSchemaID.length>0){if(this.editor)return;this.editor=new Ct.a(this.editorPreviewRef.current,{schema:e.messages.messagePreview.schema,theme:"bootstrap4"})}e.messages.messagePreview.details&&this.editor.setValue(e.messages.messagePreview.details),this.props.disabled&&this.editor&&this.editor.disable()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"button-wrap"},this.props.disabled?null:r.a.createElement("span",{onClick:this.saveMessage,className:"link"},r.a.createElement(dt.a,{icon:mt.e}),"Save Message")),r.a.createElement("div",{id:"preview-editor",ref:this.editorPreviewRef}),r.a.createElement("div",{className:"button-wrap"},this.props.disabled?null:r.a.createElement("span",{onClick:this.saveMessage,className:"link"},r.a.createElement(dt.a,{icon:mt.e}),"Save Message")))}}]),t}(n.Component),Wt=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes,selectedSchema:e.selectedSchema,umpireMenu:e.umpireMenu}})(Ut),Gt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).filterMessages=function(e){var t=e.target.value,n=a.props.messages.messages.filter(function(e){return e.title.toLowerCase().indexOf(t.toLowerCase())>-1});a.setState({messageList:n,searchInput:t.toLowerCase()})},a.state={messageToEdit:a.props.messages.messagePreviewId,messageList:a.props.messages.messages,searchInput:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(nt())}},{key:"componentWillReceiveProps",value:function(e,t){this.props.messages.messages.length!==e.messages.messages.length&&this.setState({messageToEdit:e.messages.messagePreviewId,messageList:e.messages.messages})}},{key:"render",value:function(){return r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(bt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(dt.a,{icon:mt.a,size:"2x"}))),r.a.createElement("h1",null,"Message library"),r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{id:"preview",className:"flex-content flex-content--solo-item"},r.a.createElement(Wt,{id:"preview",disabled:!1}))))}}]),t}(n.Component),Vt=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes}})(Gt),Bt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).filterMessages=function(e){var t=e.target.value,n=a.props.messageTypes.messages.filter(function(e){return e.details.title.toLowerCase().indexOf(t.toLowerCase())>-1});a.setState({messageList:n,searchQuery:t})},a.setSelectedSchemaId=function(e){a.props.dispatch(rt(e._id))},a.state={messageList:a.props.messageTypes.messages,searchInput:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(Be()),this.props.dispatch(nt())}},{key:"componentWillReceiveProps",value:function(e,t){this.props.messageTypes.messages.length!==e.messageTypes.messages.length&&this.setState({messageList:e.messageTypes.messages})}},{key:"render",value:function(){return r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(bt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(dt.a,{icon:mt.a,size:"2x"}))),r.a.createElement("h1",null,"Message library"),r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{id:"selection",className:"flex-content"},r.a.createElement(Lt,{key:"search-templates",listData:this.state.messageList,searchQuery:this.state.searchQuery,filter:this.filterMessages,selected:this.props.umpireMenu.selectedSchemaID,setSelected:this.setSelectedSchemaId,placeholder:"Select template"})),r.a.createElement("div",{id:"preview",className:"flex-content flex-content--big"},r.a.createElement(Mt,{id:"preview",disabled:!1}))))}}]),t}(n.Component),Ht=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes,umpireMenu:e.umpireMenu,currentViewURI:e.currentViewURI}})(Bt),$t=a(29),qt=a(85),Yt=a(154),Qt=a(155),zt=a(156),Jt=a(157);function Zt(e){this.jsonEditor=null,this.renderZone="string"===typeof e?document.getElementById(e):e.current}function Kt(e){Zt.call(this,e)}function Xt(e){Zt.call(this,e);var t=function(e){if(e.matches('div[data-schemapath$=".properties"] > h3 > div > button.json-editor-btntype-properties')){var t=e.parentElement.parentElement.parentElement.querySelector("h3 > span");if(t&&"properties"===t.innerText)return!0}return!1};this.observer=new MutationObserver(function(e,a){var n=!0,r=!1,s=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){i.value.addedNodes.forEach(function(e){if(1===e.nodeType)if(t(e))e.querySelector("span").innerText="Add/Remove";else if(e.matches("button.json-editor-btntype-properties")){var a=e.querySelector("i");a.classList.remove("fa-pen"),a.classList.add("fa-cog"),e.querySelector("span").innerText=""}})}}catch(o){r=!0,s=o}finally{try{n||null==c.return||c.return()}finally{if(r)throw s}}}),this.observer.observe(this.renderZone,{childList:!0,subtree:!0})}Zt.prototype.destroy=function(){this.jsonEditor&&(this.jsonEditor.destroy(),this.jsonEditor=null)},Zt.prototype.updateSchema=function(e){this.destroy(),this.jsonEditor=new Ct.a(this.renderZone,{schema:e})},Zt.prototype.validate=function(){return this.jsonEditor.validate()},Zt.prototype.getJSON=function(){return this.jsonEditor.getValue()},Kt.prototype=Object.create(Zt.prototype),Object.defineProperty(Kt.prototype,"constructor",{value:Kt,enumerable:!1,writable:!0}),Kt.prototype.updateSchema=function(e){this.destroy(),this.jsonEditor=new Ct.a(this.renderZone,{schema:e,no_additional_properties:!0})},Xt.prototype=Object.create(Zt.prototype),Object.defineProperty(Xt.prototype,"constructor",{value:Xt,enumerable:!1,writable:!0}),Xt.prototype.updateSchema=function(e){this.destroy();this.jsonEditor=new Ct.a(this.renderZone,{schema:e,custom_validators:[function(e,t,a){var n=[];return null!==t&&"integer"===t.type&&"range"===t.format&&("undefined"!==typeof t.minimum&&"undefined"!==typeof t.maximum||n.push({path:a,property:"format",message:"The range format requires that you specify both minimum and maximum properties, too."})),n},function(e,t,a){var n=[];return null===t||"integer"!==t.type&&"number"!==t.type||"undefined"!==typeof t.minimum&&"undefined"!==typeof t.minimum&&t.minimum>t.maximum&&n.push({path:a,property:"maximum",message:"The maximum value must be greater than or equal than the minimum value."}),n}]});this.jsonEditor.on("ready",function(){var e=this.root.getButton("Save","save","Save"),t=this.root.theme.getHeaderButtonHolder();t.appendChild(e),this.root.header.parentNode.insertBefore(t,this.root.header.nextSibling);var a=this;e.addEventListener("click",function(e){e.preventDefault();var t=a.getValue(),n=new Blob([JSON.stringify(t,null,2)],{type:"application/json;charset=utf-8"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,"schema.json");else{var r=document.createElement("a");r.download="schema.json",r.href=URL.createObjectURL(n),r.dataset.downloadurl=["text/plain",r.download,r.href].join(":"),r.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1}))}},!1)})};var ea=function(e){function t(e,a){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e,a))).schemaEditor=null,n.editorBox=r.a.createRef(),n.onChange=n.onChange.bind(Object($t.a)(Object($t.a)(n))),n.updateEditor=n.updateEditor.bind(Object($t.a)(Object($t.a)(n))),n.saved="",n.value=n.props.defaultValue,n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"onChange",value:function(e,t){var a=this.schemaEditor.validate();console.log(a),a.length?alert("Invalid schema"):this.props.onChange&&(this.value=this.schemaEditor.jsonEditor.getValue(),this.props.onChange(this.schemaEditor.getJSON()))}},{key:"componentDidMount",value:function(){this.schemaEditor=new Xt(this.editorBox),this.updateEditor(this.props.schema,this.props.options)}},{key:"componentWillReceiveProps",value:function(e){var t=e.schema,a=e.options;this.updateEditor(t,a)}},{key:"updateEditor",value:function(e,t){try{var a=JSON.stringify(e);a===this.save&&t.counter===this.props.options.counter||(Ct.a.defaults.options.object_layout=t.layout,Ct.a.defaults.options=Object(w.a)({},Ct.a.defaults.options,t.booleanOptions),this.save=a,this.schemaEditor.updateSchema(e),this.schemaEditor.jsonEditor.setValue(this.value),this.schemaEditor.jsonEditor.on("change",this.onChange))}catch(n){alert("Invalid json schema"),console.log(n)}}},{key:"render",value:function(){return r.a.createElement(Yt.a,null,r.a.createElement(Qt.a,null,"Schema Editor"),r.a.createElement(zt.a,null,r.a.createElement("div",{id:"schema-editor",ref:this.editorBox})),r.a.createElement(Jt.a,null))}}]),t}(n.Component),ta=function(e){function t(e,a){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e,a))).previewBox=r.a.createRef(),n.editorPreview=null,n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.editorPreview=new Kt(this.previewBox)}},{key:"componentWillReceiveProps",value:function(e){var t=e.schema;this.editorPreview.destroy(),null!==t&&this.editorPreview.updateSchema(t)}},{key:"render",value:function(){return r.a.createElement(Yt.a,null,r.a.createElement(Qt.a,null,"Editor Preview"),r.a.createElement(zt.a,null,r.a.createElement("div",{id:"editor-preview",ref:this.previewBox})),r.a.createElement(Jt.a,null,"The Editor Preview will be updated as you make changes in the Schema Editor"))}}]),t}(n.Component),aa=(a(121),function(e){function t(e,a){var n;return Object(c.a)(this,t),n=Object(l.a)(this,Object(u.a)(t).call(this,e,a)),Ct.a.defaults.options.iconlib="fontawesome5",Ct.a.defaults.options.theme="bootstrap4",n.updateMetaSchema=n.updateMetaSchema.bind(Object($t.a)(Object($t.a)(n))),n.updatePreviewSchema=n.updatePreviewSchema.bind(Object($t.a)(Object($t.a)(n))),n.updateOptions=n.updateOptions.bind(Object($t.a)(Object($t.a)(n))),n.schemaEditor=null,n.editorPreview=null,n.defaultValue={type:"object",properties:{title:{type:"string"},Date:{type:"string",format:"datetime-local"},Status:{type:"string",enum:["Minor","Major","Critical"]},Description:{type:"string",format:"textarea"}},title:"Machinery Failure",format:"grid"},n.props.schemaId&&(n.defaultValue=n.props.messageTypes.messages.find(function(e){return e._id===n.props.schemaId}).details),n.state={metaSchema:qt,previewSchema:null,options:{layout:Ct.a.defaults.options.object_layout,booleanOptions:{}}},n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"updatePreviewSchema",value:function(e){console.log("preview update"),this.setState({previewSchema:e}),this.props.dispatch(st(e))}},{key:"updateOptions",value:function(e){console.log("options update"),this.setState({options:e})}},{key:"updateMetaSchema",value:function(e){console.log("editor update"),this.setState({metaschema:e})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"flex-content flex-content--left50"},r.a.createElement(ea,{schema:this.state.metaSchema,onChange:this.updatePreviewSchema,options:this.state.options,defaultValue:this.defaultValue})),r.a.createElement("div",{className:"flex-content flex-content--right50"},r.a.createElement(ta,{schema:this.state.previewSchema})))}}]),t}(n.Component)),na=Object(m.b)(function(e){return{umpireMenu:e.umpireMenu}})(aa),ra=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).filterMessages=function(e){var t=e.target.value,n=a.props.messageTypes.messages.filter(function(e){return e.details.title.toLowerCase().indexOf(t.toLowerCase())>-1});a.setState({messageList:n,searchInput:t.toLowerCase()})},a.updateSchema=function(){a.props.dispatch(tt(a.props.umpireMenu.previewSchema,a.props.umpireMenu.selectedSchemaID))},a.state={messageList:a.props.messageTypes.messages,searchInput:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(Be()),this.props.dispatch(nt())}},{key:"componentWillReceiveProps",value:function(e,t){this.props.messageTypes.messages.length!==e.messageTypes.messages.length&&this.setState({messageList:e.messageTypes.messages})}},{key:"render",value:function(){return r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(bt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(dt.a,{icon:mt.a,size:"2x"}))),r.a.createElement("h1",null,"Message template"),r.a.createElement("div",{className:"button-wrap"},r.a.createElement("span",{onClick:this.updateSchema,className:"link"},r.a.createElement(dt.a,{icon:mt.e}),"Save Message")),r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement(na,{schemaId:this.props.umpireMenu.selectedSchemaID,messageTypes:this.props.messageTypes})),r.a.createElement("div",{className:"button-wrap"},r.a.createElement("span",{onClick:this.updateSchema,className:"link"},r.a.createElement(dt.a,{icon:mt.e}),"Save Message")))}}]),t}(n.Component),sa=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes,currentViewURI:e.currentViewURI,umpireMenu:e.umpireMenu}})(ra),ia=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).saveSchema=function(){a.props.dispatch(Xe(a.props.umpireMenu.previewSchema))},a.state={messageList:a.props.messageTypes.messages,searchInput:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(Be()),this.props.dispatch(nt())}},{key:"componentWillReceiveProps",value:function(e,t){this.props.messageTypes.messages.length!==e.messageTypes.messages.length&&this.setState({messageList:e.messageTypes.messages})}},{key:"render",value:function(){return r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(bt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(dt.a,{icon:mt.a,size:"2x"}))),r.a.createElement("h1",null,"Message template"),r.a.createElement("div",{className:"button-wrap"},r.a.createElement("span",{onClick:this.saveSchema,className:"link"},r.a.createElement(dt.a,{icon:mt.e}),"Save Message")),r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement(na,null)),r.a.createElement("div",{className:"button-wrap"},r.a.createElement("span",{onClick:this.saveSchema,className:"link"},r.a.createElement(dt.a,{icon:mt.e}),"Save Message")))}}]),t}(n.Component),ca=Object(m.b)(function(e){return{messages:e.messages,messageTypes:e.messageTypes,currentViewURI:e.currentViewURI,umpireMenu:e.umpireMenu}})(ia),oa=a(20),la=a(161),ua=a(160),pa=a(159),ma=a(158),da=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){a.props.updateStore(e.target.value)},a.state={type:a.props.options.numInput?"number":"text"},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.validInput?"":"invalid-input";return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{className:e,id:this.props.id?this.props.id:null,type:this.state.type,onChange:this.onChange,value:this.props.data?this.props.data:""}))}}]),t}(n.Component),ha=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(e){a.props.updateStore(e.target.value)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("select",{disabled:this.props.disabled,value:this.props.data?this.props.data:"placeholder",onChange:this.onChange},r.a.createElement("option",{value:"placeholder"},this.props.placeholder),this.props.selectOptions.map(function(e,t){return r.a.createElement("option",{key:"".concat(e.value).concat(e.option),value:e.value},e.option)}))}}]),t}(n.Component),fa=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"flex-content flex-content--row"},this.props.children)}}]),t}(n.Component),Ea=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(e){a.props.updateStore(e.target.value)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("textarea",{value:this.props.data,onChange:this.onChange,style:{resize:"none"}})}}]),t}(n.Component),ga=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).updateDescription=function(e){a.props.dispatch(pe({gameDescription:e}))},a.updateSpatialRepresentation=function(e){a.props.dispatch(pe({spatialRepresentation:e}))},a.updatePlanningInterval=function(e){a.props.dispatch(pe({planningInterval:e}))},a.updateReplayInterval=function(e){a.props.dispatch(pe({replayInterval:e}))},a.updateTurnStrategy=function(e){a.props.dispatch(pe({turnStrategy:e}))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{className:"flex-content flex-content--left50"},r.a.createElement("p",{className:"heading--sml"},"Game description & objectives"),r.a.createElement(Ea,{updateStore:this.updateDescription,data:this.props.wargame.tabs[this.props.wargame.currentTab].data.gameDescription})),r.a.createElement("div",{className:"flex-content flex-content--right50"},r.a.createElement(fa,null,r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml"},"Spatial Representation")),r.a.createElement("div",{className:"flex-content flex-content--fill"},r.a.createElement(ha,{updateStore:this.updateSpatialRepresentation,selectOptions:[{value:"opt1",option:"opt1"},{value:"opt2",option:"opt2"},{value:"opt3",option:"opt3"}],placeholder:"Select spatial representation",data:this.props.wargame.tabs[this.props.wargame.currentTab].data.spatialRepresentation}))),r.a.createElement(fa,null,r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml"},"Planning Interval")),r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement(da,{updateStore:this.updatePlanningInterval,options:{numInput:!0},data:this.props.wargame.tabs[this.props.wargame.currentTab].data.planningInterval,validInput:!0})),r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml heading--mleft"},"min."))),r.a.createElement(fa,null,r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml"},"Replay interval")),r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement(da,{updateStore:this.updateReplayInterval,options:{numInput:!0},data:this.props.wargame.tabs[this.props.wargame.currentTab].data.replayInterval,validInput:!0})),r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml heading--mleft"},"min."))),r.a.createElement(fa,null,r.a.createElement("div",{className:"flex-content flex-content--sml"},r.a.createElement("p",{className:"heading--sml"},"Turn Strategy")),r.a.createElement("div",{className:"flex-content flex-content--fill"},r.a.createElement(ha,{updateStore:this.updateTurnStrategy,selectOptions:[{value:"opt1",option:"opt1"},{value:"opt2",option:"opt2"},{value:"opt3",option:"opt3"}],placeholder:"Not implemented yet",data:this.props.wargame.tabs[this.props.wargame.currentTab].data.turnStrategy})))))}}]),t}(n.Component),ba=Object(m.b)(function(e){return{wargame:e.wargame}})(ga),ya=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).setSelected=function(e){a.props.setSelected(e)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"createList",value:function(){var e=this.props.listData,t=[];for(var a in e){var n=a===this.props.selected?"active":"";t.unshift(r.a.createElement("span",{href:"#",onClick:this.setSelected.bind(this,a),key:a,className:vt()({"list-title":!0,active:n})},a))}return t}},{key:"render",value:function(){return r.a.createElement("div",{className:"list"},!!this.props.filter&&r.a.createElement("input",{type:"text",className:"list-input",key:"search-templates",placeholder:this.props.placeholder,onChange:this.props.filter,value:this.props.searchQuery}),r.a.createElement("div",{className:"list-list"},this.createList()))}}]),t}(n.Component),va=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("span",{className:"group-item",key:this.props.children},this.props.children,r.a.createElement(dt.a,{icon:mt.f}))}}]),t}(n.Component),Sa=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).openModal=function(){a.props.dispatch(h.open("addForce"))},a.setSelected=function(e){a.props.dispatch(he(e))},a.updateOverview=function(e){a.props.dispatch(ge(e))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"createForceEditor",value:function(){var e=this.props.wargame.currentTab,t=this.props.wargame.tabs[e].data.selectedForce;return r.a.createElement("div",{className:"flex-content--fill forcesTab"},r.a.createElement("h3",null,t),r.a.createElement("span",{className:"link link--secondary link--noIcon link--disabled"},"Change icon"),r.a.createElement("p",{className:"heading--sml"},"Overview & Objectives"),r.a.createElement(Ea,{updateStore:this.updateOverview,data:this.props.wargame.tabs[e].data.forces[t].overview}),r.a.createElement("p",{className:"heading--sml"},"Roles"),r.a.createElement("span",{className:"link link--secondary link--noIcon link--disabled"},"Add a new role"),r.a.createElement("div",{className:"flex-content"},this.props.wargame.tabs[e].data.forces[t].roles.map(function(e){return r.a.createElement(va,{key:e},e)})))}},{key:"render",value:function(){var e=this.props.wargame.currentTab,t=this.props.wargame.tabs[e].data.selectedForce;return r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{className:"flex-content"},r.a.createElement("span",{className:"link link--noIcon",onClick:this.openModal},"Add a new force"),r.a.createElement(ya,{listData:this.props.wargame.tabs[e].data.forces,setSelected:this.setSelected,selected:t})),t?this.createForceEditor():null)}}]),t}(n.Component),Oa=Object(m.b)(function(e){return{messages:e.messages,wargame:e.wargame}})(Sa),wa=a(42),ja=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).updateSubscriptionForce=function(e){a.setState({editSubscriptionForce:e})},a.updateSubscriptionRole=function(e){a.setState({editSubscriptionRole:e})},a.updateSubscriptionTemplates=function(e){a.setState({editSubscriptionTemplates:e})},a.updateChannel=function(){var e={force:a.state.editSubscriptionForce.label,role:a.state.editSubscriptionRole.label,templates:a.state.editSubscriptionTemplates};a.props.updateRecipient(a.state.subscriptionId,e),a.props.cancelEdit()},a.state={subscriptionId:a.props.data.subscriptionId,editSubscriptionForce:{value:a.props.data.force,label:a.props.data.force},editSubscriptionRole:{value:a.props.data.role,label:a.props.data.role},editSubscriptionTemplates:a.props.data.templates},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(wa.a,{value:this.state.editSubscriptionForce,options:this.props.forceOptions,onChange:this.updateSubscriptionForce})),r.a.createElement("td",null,r.a.createElement(wa.a,{value:this.state.editSubscriptionRole,options:this.props.roleOptions,onChange:this.updateSubscriptionRole})),r.a.createElement("td",null,r.a.createElement(wa.a,{value:this.state.editSubscriptionTemplates,options:this.props.templateOptions,onChange:this.updateSubscriptionTemplates,isMulti:!0})),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-action btn-action--secondary",onClick:this.updateChannel},"Save")))}}]),t}(n.Component),_a=Object(m.b)()(ja),Ta=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).cancelEdit=function(){a.setState({subscriptionToEdit:""})},a.updateRecipient=function(e,t){a.props.dispatch(Se(e,t))},a.setSelectedForce=function(e){a.setState({selectedForce:e})},a.setSelectedRole=function(e){a.setState({selectedRole:e})},a.setSelectedTemplate=function(e){a.setState({selectedTemplates:e})},a.addToChannel=function(){var e={force:a.state.selectedForce.value,role:a.state.selectedRole.value,templates:a.state.selectedTemplates};a.props.dispatch(ve(e)),a.setState({selectedForce:{value:null,label:null},selectedRole:{value:null,label:null},selectedTemplates:[]})};var n=Object.values(a.props.wargame.tabs).find(function(e){return"Forces"===e.name}).data.forces,r=[];for(var s in n)r.push({value:s,label:s});var i=a.props.messageTypes.messages.map(function(e){return{value:e._id,label:e.title}});return a.state={selectedForce:{value:null,label:null},forceOptions:r,selectedRole:{value:null,label:null},roleOptions:[],selectedTemplates:[],templateOptions:i,subscriptionToEdit:null,editSubscriptionForce:"",editSubscriptionRole:"",editSubscriptionTemplates:[]},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillUpdate",value:function(e,t,a){if(null!==t.selectedForce.value&&this.state.selectedForce.value!==t.selectedForce.value){var n=Object.values(this.props.wargame.tabs),r=[];n.find(function(e){return"Forces"===e.name}).data.forces[t.selectedForce.value].roles.forEach(function(e){r.push({value:e,label:e})}),this.setState({roleOptions:r})}}},{key:"createRow",value:function(e,t){var a=[];for(var n in e)if("subscriptionId"!==n){var s="";if("string"!==typeof e[n])for(var i=0;i<e[n].length;i++){s+=e[n][i].label,i!==e[n].length-1&&(s+=", ")}else s=e[n];a.push(r.a.createElement("td",{key:"".concat(s).concat(t)},s))}return a.push(r.a.createElement("td",{key:"edit-delete".concat(t)},r.a.createElement(dt.a,{icon:mt.g,onClick:this.removeSubscription.bind(this,e.subscriptionId)}),r.a.createElement(dt.a,{icon:mt.c,onClick:this.editSubscription.bind(this,e.subscriptionId)}))),r.a.createElement("tr",{key:"row-".concat(t)},a)}},{key:"removeSubscription",value:function(e){var t;this.props.dispatch((t=e,{type:d.REMOVE_RECIPIENT,payload:t}))}},{key:"editSubscription",value:function(e){this.setState({subscriptionToEdit:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"flex-content"},r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Force"),r.a.createElement("th",null,"Roles"),r.a.createElement("th",null,"Templates"))),r.a.createElement("tbody",null,this.props.data.map(function(t,a){return t.subscriptionId===e.state.subscriptionToEdit?r.a.createElement(_a,{key:t.subscriptionId,data:t,forceOptions:e.state.forceOptions,roleOptions:e.state.roleOptions,templateOptions:e.state.templateOptions,cancelEdit:e.cancelEdit,updateRecipient:e.updateRecipient}):e.createRow(t,a)}),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(wa.a,{value:this.state.selectedForce,options:this.state.forceOptions,onChange:this.setSelectedForce})),r.a.createElement("td",null,r.a.createElement(wa.a,{value:this.state.selectedRole,options:this.state.roleOptions,onChange:this.setSelectedRole,isDisabled:!this.state.selectedForce.value})),r.a.createElement("td",null,r.a.createElement(wa.a,{value:this.state.selectedTemplates,options:this.state.templateOptions,onChange:this.setSelectedTemplate,isDisabled:!this.state.selectedRole.value,isMulti:!0})),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-action btn-action--secondary",onClick:this.addToChannel,disabled:!this.state.selectedTemplates.length>0},"Save"))))))}}]),t}(n.Component),ka=Object(m.b)(function(e){return{wargame:e.wargame,messageTypes:e.messageTypes}})(Ta),Ca=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).openModal=function(){a.props.dispatch(h.open("addChannel"))},a.setSelected=function(e){a.props.dispatch(Ee(e))},a.updateOverview=function(e){a.props.dispatch(ge(e))},a.filterChannels=function(e){var t=e.target.value,n=a.props.wargame.tabs[a.props.wargame.currentTab].data.channels,r={};for(var s in n)s.toLowerCase().indexOf(t.toLowerCase())>-1&&(r[s]=n[s]);a.setState({channelList:r,searchQuery:t})},a.state={channelList:a.props.wargame.tabs[a.props.wargame.currentTab].data.channels,searchQuery:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=Object.keys(this.props.wargame.tabs[this.props.wargame.currentTab].data.channels),n=Object.keys(e.wargame.tabs[e.wargame.currentTab].data.channels);a.length!==n.length&&this.setState({channelList:e.wargame.tabs[e.wargame.currentTab].data.channels})}},{key:"createChannelEditor",value:function(){var e=this.props.wargame.currentTab,t=this.props.wargame.tabs[e].data.selectedChannel;return r.a.createElement("div",{className:"flex-content--fill channelsTab"},r.a.createElement("h3",null,t),r.a.createElement("p",{className:"heading--sml"},"Participants and messages"),r.a.createElement(ka,{data:this.props.wargame.tabs[e].data.channels[t]}))}},{key:"render",value:function(){var e=this.props.wargame.currentTab,t=this.props.wargame.tabs[e].data.selectedChannel;return r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{className:"flex-content"},r.a.createElement("span",{className:"link link--noIcon",onClick:this.openModal},"Add channel"),r.a.createElement(ya,{listData:this.state.channelList,filter:this.filterChannels,searchQuery:this.state.searchQuery,setSelected:this.setSelected,selected:t,placeholder:"Search channels"})),t?this.createChannelEditor():null)}}]),t}(n.Component),Na=Object(m.b)(function(e){return{messages:e.messages,wargame:e.wargame}})(Ca),Ma=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"invalid-notification"},r.a.createElement("p",null,this.props.children)))}}]),t}(n.Component);function Ia(e){return r.a.createElement(ma.a,{component:"div",style:{padding:24}},e.children)}var Aa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e,t){a.setState({value:t}),a.props.setCurrentTab(t)},console.log(a.props.tabs),a.state={value:0,tabs:Object.values(a.props.tabs).map(function(e){return e.name}),invalidFields:[]},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.setCurrentTab(0)}},{key:"render",value:function(){var e=this.state.value,t=this.props.classes;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.root},r.a.createElement(la.a,{position:"static",color:"default"},r.a.createElement(ua.a,{value:e,onChange:this.handleChange,indicatorColor:"primary",textColor:"primary",centered:!0},this.state.tabs.map(function(e,t){return r.a.createElement(pa.a,{key:e+t,label:e})}))),0===e&&r.a.createElement(Ia,null,r.a.createElement(ba,null)),1===e&&r.a.createElement(Ia,null,r.a.createElement(Oa,null)),2===e&&r.a.createElement(Ia,null,r.a.createElement(Na,null))),r.a.createElement(Ma,{validation:this.props.wargame.validation}))}}]),t}(n.Component),xa=Object(m.b)(function(e){return{wargame:e.wargame}})(Object(oa.a)(function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper}}})(Aa)),Ra=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"progress"},this.props.children)}}]),t}(n.Component),Da=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).setCurrentTab=function(e){a.props.dispatch(ue(e))},a.updateWargameTitle=function(e){a.props.dispatch(me(e))},a.saveWargame=function(){a.checkAllValid()&&a.props.dispatch(je(a.props.wargame.currentWargame,a.props.wargame.tabs,a.props.wargame.wargameTitle))},a.checkAllValid=function(){return Object.values(a.props.wargame.validation).reduce(function(e){return!0===e})},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(nt())}},{key:"createIndicators",value:function(){var e=this;return Object.entries(this.props.wargame.tabs).map(function(t){var a=e.props.wargame.currentTab===parseInt(t[0]),n=t[1].complete;return r.a.createElement("div",{key:t[0],className:vt()("progress-indicator",{"progress-indicator--active":a,"progress-indicator--complete":n})})})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"view-wrapper view-wrapper-gamesetup"},r.a.createElement("div",{id:"sidebar"},r.a.createElement(bt,{href:"/client/umpireMenu",id:"home-btn"},r.a.createElement(dt.a,{icon:mt.a,size:"2x"}))),r.a.createElement("div",{className:"flex-content-wrapper flex-content-wrapper--distribute",id:"game-setup-head"},r.a.createElement(da,{id:"title-editable",updateStore:this.updateWargameTitle,options:{numInput:!1},data:this.props.wargame.wargameTitle,validInput:this.props.wargame.validation.validWargameName}),r.a.createElement("span",{className:vt()({link:!0,"link--noIcon":!0,"link--disabled":!this.checkAllValid()}),onClick:this.saveWargame},"save"),r.a.createElement(Ra,null,this.createIndicators())),r.a.createElement(xa,{tabs:this.props.wargame.tabs,setCurrentTab:this.setCurrentTab})))}}]),t}(n.Component),La=Object(m.b)(function(e){return{wargame:e.wargame}})(Da),Pa=a(93),Fa=a.n(Pa),Ua=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"createObjItem",value:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{key:"objItem--".concat(e[0],"-").concat(e[1]),className:"group-section"},this.deconstructObj(e[1])))}},{key:"createBoolItem",value:function(e){return r.a.createElement("span",{key:"boolItem--".concat(e[0],"-").concat(e[1])},!!e[1]&&e[0])}},{key:"createTimeItem",value:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"detail"},e[0],":"),r.a.createElement("span",{key:"dateTime-".concat(e[1]),className:"data"},At()(e[1]).format("DD/MM/YY,HH:mm")))}},{key:"createStrItem",value:function(e,t){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{key:"strItem-".concat(e[0]),className:"detail"},e[0],":"),r.a.createElement("span",{className:"data"},e[1]))}},{key:"deconstructArr",value:function(e){var t=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"detail"},e[0]),e[1].map(function(e){return r.a.createElement("span",{key:"section-".concat(e.name)},t.deconstructObj(e))}))}},{key:"deconstructObj",value:function(e){var t=this;return Object.entries(e).map(function(e,a){return Ne.a.object(e[1])?t.createObjItem(e):Ne.a.array.of.object(e[1])?t.deconstructArr(e):Ne.a.boolean(e[1])?t.createBoolItem(e):At()(e[1],At.a.ISO_8601,!0).isValid()?t.createTimeItem(e):t.createStrItem(e)})}},{key:"render",value:function(){var e=this;if(!this.props.detail)return!1;var t=this;return Object.entries(this.props.detail).map(function(a,n){return 0===n?r.a.createElement(r.a.Fragment,null,!!e.props.from&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{key:"from",className:"detail"},"From:"),r.a.createElement("span",{className:"data"},e.props.from))):Ne.a.object(a[1])?t.createObjItem(a):Ne.a.array.of.object(a[1])?t.deconstructArr(a):Ne.a.boolean(a[1])?t.createBoolItem(a):At()(a[1],At.a.ISO_8601,!0).isValid()?t.createTimeItem(a):r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"detail"},a[0],": "),r.a.createElement("span",{key:"".concat(a[0],"-").concat(a[1]),className:"data"},a[1]))})}}]),t}(n.Component),Wa=Object(m.b)()(Ua),Ga=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.props.messages.filter(function(t){return t.details.channel===e.props.curChannel});return r.a.createElement(r.a.Fragment,null,t.map(function(e,t){return r.a.createElement(Fa.a,{trigger:e.message.title,transitionTime:200,easing:"ease-in-out",open:0===t},r.a.createElement("div",{className:"message-preview-player"},r.a.createElement(Wa,{key:t,detail:e.message,from:e.details.from.force})))}))}}]),t}(n.Component),Va=Object(m.b)(function(){return{}})(Ga),Ba=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).sendMessage=function(){var e={channel:a.props.playerUi.selectedChannel,from:{force:a.props.playerUi.selectedForce,role:a.props.selectedRole}};a.props.dispatch(Y(a.props.playerUi.currentWargame,e,a.editor.getValue())),a.props.dispatch(z(a.props.playerUi.currentWargame))},a.editor=null,a.editorPreviewRef=r.a.createRef(),a.state={selectedSchema:""},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){if(this.editor&&(this.editor.destroy(),this.editor=null),e.schema&&e.schema.type){if(this.editor)return;this.editor=new Ct.a(this.editorPreviewRef.current,{schema:e.schema,theme:"bootstrap4"})}}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"preview-editor",ref:this.editorPreviewRef}),r.a.createElement("button",{name:"send",className:"btn btn-action btn-action--primary",onClick:this.sendMessage},"Send"))}}]),t}(n.Component),Ha=Object(m.b)(function(e){return{playerUi:e.playerUi}})(Ba),$a=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).setTemplate=function(e){a.props.dispatch(Q(e.value)),a.setState({template:e})},a.state={template:{value:"",label:""}},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){this.props.curChannel!==e.curChannel&&this.setState({template:{value:"",label:""}})}},{key:"render",value:function(){return r.a.createElement("div",{className:""},r.a.createElement(wa.a,{value:this.state.template,options:this.props.templates,onChange:this.setTemplate}),r.a.createElement(Ha,{schema:this.props.schema}))}}]),t}(n.Component),qa=Object(m.b)(function(){return{}})($a);function Ya(e){return r.a.createElement(ma.a,{component:"div",style:{padding:24}},e.children)}var Qa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e,t){var n=Object.keys(a.props.playerUi.channels)[t];a.props.dispatch(B(n)),a.props.dispatch(H({})),a.setState({value:t})},a.createTabs=function(){var e=a.props.playerUi.channels,t=[];for(var n in e)t.push(r.a.createElement(pa.a,{key:n,label:n}));return t},a.createMessageList=function(e){var t=a.props.playerUi.selectedChannel;return r.a.createElement(Ya,null,r.a.createElement(Va,{curChannel:t,messages:a.props.playerUi.messages}),r.a.createElement(qa,{curChannel:t,schema:a.props.playerUi.messageSchema,templates:a.props.playerUi.channels[t].templates}))},a.state={value:0},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.dispatch(z(this.props.playerUi.currentWargame))}},{key:"render",value:function(){var e=this.state.value,t=this.props.classes;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.root},r.a.createElement(la.a,{position:"static",color:"default"},r.a.createElement(ua.a,{value:e,onChange:this.handleChange,indicatorColor:"primary",textColor:"primary",centered:!0},this.createTabs())),this.createMessageList(e)))}}]),t}(n.Component),za=Object(m.b)(function(e){return{playerUi:e.playerUi}})(Object(oa.a)(function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper}}})(Qa)),Ja=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).updateSelectedWargame=function(e){a.props.dispatch(q(e))},a.updateSelectedForce=function(e){a.props.dispatch(W(e))},a.updateSelectedRole=function(e){a.props.dispatch(G(e)),a.props.dispatch(V())},a.goBack=function(){a.props.dispatch(W(""))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"flex-content-wrapper"},r.a.createElement("div",{className:"flex-content flex-content--fill"},!this.props.playerUi.currentWargame&&r.a.createElement("div",{className:"flex-content--center"},r.a.createElement("h1",null,"Set wargame"),r.a.createElement(ha,{updateStore:this.updateSelectedWargame,selectOptions:this.props.wargame.wargameList.map(function(e){return{option:e.title,value:e.name}})})),!(!this.props.playerUi.currentWargame||this.props.playerUi.selectedForce)&&r.a.createElement("div",{className:"flex-content--center"},r.a.createElement("h1",null,"Set force"),r.a.createElement(ha,{updateStore:this.updateSelectedForce,selectOptions:Object.keys(this.props.playerUi.allForces).map(function(e){return{option:e,value:e}})})),!(!this.props.playerUi.selectedForce||this.props.playerUi.selectedRole)&&r.a.createElement("div",{className:"flex-content--center"},r.a.createElement("h1",null,"Set role"),r.a.createElement(dt.a,{icon:mt.a,size:"2x",style:{cursor:"pointer"},onClick:this.goBack}),r.a.createElement(ha,{updateStore:this.updateSelectedRole,selectOptions:this.props.playerUi.allForces[this.props.playerUi.selectedForce].roles.map(function(e){return{option:e,value:e}})})),!(!this.props.playerUi.selectedForce||!this.props.playerUi.selectedRole)&&r.a.createElement("div",{className:"message-feeds"},r.a.createElement(za,null))))}}]),t}(n.Component),Za=Object(m.b)(function(e){return{playerUi:e.playerUi,wargame:e.wargame}})(Ja),Ka=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).routes=[{path:"/client/",action:function(){return r.a.createElement(Ot,null)}},{path:"/client/umpireMenu",action:function(){return r.a.createElement(Tt,null)}},{path:"/client/umpireMenu/:creatorType",action:function(){return r.a.createElement(Ft,null)}},{path:"/client/messageCreator",children:[{path:"/create/template",action:function(){return r.a.createElement(ca,null)}},{path:"/edit/template",action:function(){return r.a.createElement(sa,null)}},{path:"/create/message",action:function(){return r.a.createElement(Ht,null)}},{path:"/edit/message",action:function(){return r.a.createElement(Vt,null)}}]},{path:"/client/gameSetup",action:function(){return r.a.createElement(La,null)}},{path:"/client/playerUi",action:function(){return r.a.createElement(Za,null)}}],a.state={currentView:r.a.createElement(Ot,null)},a.router=new Et.a(a.routes),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.router.resolve({pathname:e.currentViewURI}).then(function(e){a.setState({currentView:e})})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.currentView)}}]),t}(n.Component),Xa=Object(m.b)(function(e){return{currentViewURI:e.currentViewURI}})(Ka),en=a(51);function tn(e){if(null===e||"object"!==typeof e)return e;var t=e.constructor();for(var a in e)t[a]=tn(e[a]);return t}var an={isLoading:!1,messages:[]},nn={isLoading:!1,messages:[],messagePreviewId:"",messagePreview:{}},rn={selectedSchemaID:"",previewSchema:{}},sn={isLoading:!1,wargameList:[],currentWargame:"",wargameTitle:"",validation:{validWargameName:!0},tabs:{0:{name:"Overview - settings",data:{gameDescription:"",spatialRepresentation:"",planningInterval:null,replayInterval:null,turnStrategy:""},complete:!1},1:{name:"Forces",data:{forces:{},selectedForce:"",roles:[]},complete:!1},2:{name:"Channels",data:{channels:{},selectedChannel:""},complete:!1}},currentTab:0},cn={open:!1,message:""};var on={selectedForce:"",selectedRole:"",selectedChannel:"",currentWargame:"",wargameTitle:"",channels:{},allChannels:{},forces:{},allForces:{},messageSchema:{},messages:[]},ln=[a(94).a],un=Object(en.d)(Object(en.c)({messageTypes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:an,t=arguments.length>1?arguments[1]:void 0,a=tn(e);switch(t.type){case d.DB_MESSAGE_TYPES_GET:return a.isLoading=t.isLoading,a;case d.DB_MESSAGE_TYPES_SAVED:return a.messages=t.payload,a;default:return a}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nn,t=arguments.length>1?arguments[1]:void 0,a=tn(e);switch(t.type){case d.DB_MESSAGES_GET:return a.isLoading=t.isLoading,a;case d.DB_MESSAGE_SAVED:return a.messages=t.payload,a;case d.DB_RETURNED_MESSAGE:return a.messagePreviewId=t.payload._id,a.messagePreview=t.payload,a;case d.RESET_MESSAGE_PREVIEW:return a.messagePreviewId="",a.messagePreview={},a;default:return a}},umpireMenu:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rn,t=arguments.length>1?arguments[1]:void 0,a=tn(e);switch(t.type){case d.SET_SELECTED_SCHEMA:return a.selectedSchemaID=t.payload,a;case d.SET_PREVIEW_SCHEMA:return a.previewSchema=t.payload,a;default:return a}},currentViewURI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=arguments.length>1?arguments[1]:void 0,a=e;switch(t.type){case d.SET_CURRENT_VIEW_FROM_URI:return window.history.pushState({},"",t.payload),a=t.payload;default:return a}},currentModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;tn(e);switch(t.type){case d.OPEN_MODAL:case d.CLOSE_MODAL:return t.payload;default:return{}}},notification:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cn,t=arguments.length>1?arguments[1]:void 0,a=tn(e);switch(t.type){case d.SHOW_NOTIFICATION:case d.HIDE_NOTIFICATION:return a=t.payload;default:return a}},wargame:function(){var e,t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sn,n=arguments.length>1?arguments[1]:void 0,r=tn(a),s=r.currentTab;switch(n.type){case d.ALL_WARGAME_NAMES_SAVED:return r.wargameList=n.payload,r;case d.SET_CURRENT_WARGAME:return r.currentWargame=n.payload.name,r.wargameTitle=n.payload.wargameTitle,r.tabs=n.payload.tabs,r;case d.SET_WARGAME_NAME:var i=[];r.wargameList.forEach(function(e){e.name!==r.currentWargame&&i.push(e)});var c=i.every(function(e){return e.title!==n.payload});return r.validation.validWargameName=c,r.wargameTitle=n.payload,r;case d.SET_CURRENT_GAME_SETUP_TAB:r.currentTab=n.payload;break;case d.SET_GAME_SETUP_DATA:r.tabs[s].data=Object(w.a)({},r.tabs[s].data,n.payload);break;case d.ADD_NEW_FORCE:r.tabs[s].data.forces[n.payload]=N;break;case d.SET_SELECTED_FORCE:r.tabs[s].data.selectedForce=n.payload;break;case d.ADD_NEW_CHANNEL:r.tabs[s].data.channels[n.payload]=M;break;case d.SET_SELECTED_CHANNEL:r.tabs[s].data.selectedChannel=n.payload;break;case d.SET_FORCE_OVERVIEW:var o=r.tabs[s].data.selectedForce;r.tabs[s].data.forces[o].overview=n.payload;break;case d.ADD_NEW_RECIPIENT:e=r.tabs[s].data.selectedChannel;var l=Object(w.a)({},n.payload,{subscriptionId:_.a.time()});r.tabs[s].data.channels[e].push(l);break;case d.UPDATE_RECIPIENT:e=r.tabs[s].data.selectedChannel,t=r.tabs[s].data.channels[e].findIndex(function(e){return e.subscriptionId===n.payload.id}),r.tabs[s].data.channels[e].splice(t,1,Object(w.a)({},n.payload.data,{subscriptionId:n.payload.id}));break;case d.REMOVE_RECIPIENT:e=r.tabs[s].data.selectedChannel,t=r.tabs[s].data.channels[e].findIndex(function(e){return e.subscriptionId===n.payload}),r.tabs[s].data.channels[e].splice(t,1);break;default:return r}var u=O.a.flatMapDeep(r.tabs[s].data,function e(t){return O.a.isEmpty(t)?null:O.a.isArray(t)||O.a.isObject(t)?O.a.flatMapDeep(t,e):t});return r.tabs[s].complete=u.every(function(e){return null!==e&&e.length>0}),r},playerUi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:on,t=arguments.length>1?arguments[1]:void 0,a=function e(t){if(null===t||"object"!==typeof t)return t;var a=t.constructor();for(var n in t)a[n]=e(t[n]);return a}(e);switch(t.type){case d.SET_CURRENT_WARGAME_PLAYER:a.currentWargame=t.payload.name,a.wargameTitle=t.payload.wargameTitle;var n=Object.values(t.payload.tabs).find(function(e){return"Channels"===e.name});a.allChannels=n.data.channels;var r=Object.values(t.payload.tabs).find(function(e){return"Forces"===e.name});a.allForces=r.data.forces;break;case d.SET_FORCE:a.selectedForce=t.payload;break;case d.SET_ROLE:a.selectedRole=t.payload;break;case d.SET_FILTERED_CHANNELS:var s={};for(var i in a.allChannels){var c=a.allChannels[i].filter(function(e){return e.force===a.selectedForce&&e.role===a.selectedRole}),o=a.allChannels[i].some(function(e){return e.force===a.selectedForce&&e.role===a.selectedRole});c=O.a.uniqWith(c,O.a.isEqual),o&&(s[i]={templates:O.a.flatMap(c,function(e){return e.templates}),messages:[]})}a.selectedChannel=Object.keys(s)[0],a.channels=s;break;case d.SET_CHANNEL:a.selectedChannel=t.payload;break;case d.SET_MESSAGE_SCHEMA:a.messageSchema=t.payload;break;case d.SET_LATEST_MESSAGES:a.messages=t.payload;break;default:return a}return a}}),en.a.apply(void 0,ln)),pn=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){document.title="Serge"}},{key:"render",value:function(){return r.a.createElement(m.a,{store:un},r.a.createElement(Xa,null),r.a.createElement(pt,null),r.a.createElement(ft,null))}}]),t}(n.Component);i.a.render(r.a.createElement(pn,null),document.getElementById("root"))},14:function(e,t,a){},82:function(e){e.exports={type:"object",properties:{title:{type:"string",Title:"Title"},Date:{type:"string",format:"datetime-local",options:{flatpickr:{wrap:!0,time_24hr:!0,allowInput:!0}}},Status:{type:"string",enum:["Minor","Major","Critical"]},Description:{type:"string",format:"textarea"}},title:"Machinery Failure"}},83:function(e){e.exports={type:"object",properties:{title:{type:"string",title:"Title"},Location:{type:"object",properties:{Lat:{type:"number"},"Lat Hemi":{type:"string",enum:["N","S"]},Long:{type:"number"},"Long Hemi":{type:"string",enum:["E","W"]}},format:"grid"},"Valid from":{type:"string",format:"datetime-local",options:{flatpickr:{wrap:!0,time_24hr:!0,allowInput:!0}}},"Valid until":{type:"string",format:"datetime-local",options:{flatpickr:{wrap:!0,time_24hr:!0,allowInput:!0}}},Forecast:{type:"string",format:"textarea"}},title:"Weather Forecast"}},85:function(e){e.exports={$ref:"#/definitions/object",title:"object type",definitions:{string:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"string type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"string"},format:{type:"string",enum:["color","date","datetime","datetime-local","email","month","number","range","tel","text","textarea","time","url","week","json","sql","xml","yaml"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["string"]},enum:{format:"table",items:{title:"alternative",type:"string"},type:"array"},description:{type:"string"}}},null:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"null type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"null"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["null"]},description:{type:"string"}}},array:{required:["type"],defaultProperties:["type","items","title"],additionalProperties:!1,title:"array type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"array"},format:{default:"table",type:"string",enum:["array","table","tabs","tabs-top","checkbox","select","categories"]},items:{$ref:"#/definitions/schema"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["array"]},description:{type:"string"}}},schema:{default:{type:"object"},oneOf:[{$ref:"#/definitions/null",title:"null type"},{$ref:"#/definitions/boolean",title:"boolean type"},{$ref:"#/definitions/string",title:"string type"},{$ref:"#/definitions/integer",title:"integer type"},{$ref:"#/definitions/number",title:"number type"},{$ref:"#/definitions/object",title:"object type"},{$ref:"#/definitions/array",title:"array type"}],options:{keep_oneof_values:!1},type:"object"},boolean:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"boolean type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"boolean"},format:{type:"string",enum:["select","checkbox"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["boolean"]},description:{type:"string"}}},object:{required:["type"],defaultProperties:["type","properties","title"],additionalProperties:!1,title:"object type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"object"},format:{type:"string",enum:["grid"]},required:{uniqueItems:!0,format:"table",items:{title:"property",type:"string"},type:"array"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["object"]},description:{type:"string"},properties:{type:"object",patternProperties:{".*":{$ref:"#/definitions/propertySchema"}}}}},number:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"number type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"number"},default:{type:"number"},minimum:{type:"number"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["number"]},enum:{format:"table",items:{title:"alternative",type:"number"},type:"array"},description:{type:"string"}}},integer:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"integer type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"integer"},default:{type:"integer"},minimum:{type:"integer"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["integer"]},enum:{format:"table",items:{title:"alternative",type:"integer"},type:"array"},description:{type:"string"}}},propertySchema:{default:{type:"object"},oneOf:[{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"null type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"null"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["null"]},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"boolean type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"boolean"},format:{type:"string",enum:["select","checkbox"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["boolean"]},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"string type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"string"},format:{type:"string",enum:["color","date","datetime","datetime-local","email","month","number","range","tel","text","textarea","time","url","week","json","sql","xml","yaml"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["string"]},enum:{format:"table",items:{title:"alternative",type:"string"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"integer type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"integer"},default:{type:"integer"},minimum:{type:"integer"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["integer"]},enum:{format:"table",items:{title:"alternative",type:"integer"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"number type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"number"},default:{type:"number"},minimum:{type:"number"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["number"]},enum:{format:"table",items:{title:"alternative",type:"number"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type","properties"],additionalProperties:!1,title:"object type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"object"},format:{type:"string",enum:["grid"]},required:{uniqueItems:!0,format:"table",items:{title:"property",type:"string"},type:"array"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["object"]},description:{type:"string"},properties:{type:"object",patternProperties:{".*":{$ref:"#/definitions/propertySchema"}}}}},{required:["type"],defaultProperties:["type","items"],additionalProperties:!1,title:"array type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"array"},format:{default:"table",type:"string",enum:["array","table","tabs","tabs-top","checkbox","select","categories"]},items:{$ref:"#/definitions/schema"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["array"]},description:{type:"string"}}}],options:{keep_oneof_values:!1},type:"object"}}}}},[[105,1,2]]]);
//# sourceMappingURL=main.17f454c5.chunk.js.map